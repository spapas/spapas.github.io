<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta name="google-site-verification" content="5_8DTmIiEq4gFvNAfxAD6TsGOgrMAjp8lQFQvfA6zZc" />
    <title>A comprehensive Django CBV guide &mdash; /var/</title>
    <meta name="author" content="Serafeim Papastefanos">


    
<style type="text/css">
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .pm { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation.Marker */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}

div.collapseheader {
    width=100%;
    background-color:#d3d3d3;
    padding: 2px;
    cursor: pointer;
    font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;
}
</style>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true,
        displayMath: [['$$','$$'], ["\\[","\\]"]]
    }
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
        });
    });
});
});
</script>






    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://www.spapas.net/favicon.png" rel="icon">

    <link href="https://www.spapas.net/theme/css/main.css" media="screen, projection" rel="stylesheet"
      type="text/css">

    <link href="https://www.spapas.net/theme/css/extra_style.css" media="screen, projection" rel="stylesheet"
      type="text/css">

    <link href="https://fonts.googleapis.com/css?family=Fira+Mono|Fira+Sans:400,700&amp;subset=greek" rel="stylesheet">

<style>
#gHPzseYvFrhZ123 {
  padding: 5px !important;
  display: block;
  margin-bottom: 10px !important;
  background: #900;
  color: #fff;
  border-radius: 5px;
  font-size: 1.0rem !important;
}
</style>


  <script>
    
      
  </script>

    <script data-ad-client="ca-pub-7673322832689008" async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
      onerror="adBlockFunction();"></script>
  </head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://www.spapas.net/">/var/</a></h1>
    <h2>Various programming stuff</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
      <li >
        <a href="https://www.spapas.net/category/ai.html">Ai</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/android.html">Android</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/clojure.html">Clojure</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/css.html">Css</a>
      </li>
      <li class="active">
        <a href="https://www.spapas.net/category/django.html">Django</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/elixir.html">Elixir</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/flask.html">Flask</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/gaming.html">Gaming</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/git.html">Git</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/html.html">Html</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/javascript.html">Javascript</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/networking.html">Networking</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/pelican.html">Pelican</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/postgresql.html">Postgresql</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/python.html">Python</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/spring.html">Spring</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/unix.html">Unix</a>
      </li>
      <li >
        <a href="https://www.spapas.net/category/wagtail.html">Wagtail</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
    <div id="gHPzseYvFrhZ123">
      Hello! If you are using an ad blocker but find something useful here 
      and want to support me please consider disabling your ad blocker for this site. 
      <br />
      <br />
      Thank you,<br />
      Serafeim
      
    </div>
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">A comprehensive Django CBV guide</h1>
    <p class="meta">
<time datetime="2018-03-19T12:20:00+02:00" pubdate>Mon 19 March 2018</time>    </p>
</header>

<div class="entry-content"><div class="contents topic" id="contents">
<p class="topic-title"><a class="reference internal" href="#top">Contents</a></p>
<ul class="simple">
<li><a class="reference internal" href="#a-gentle-introduction-to-cbvs" id="toc-entry-1">A gentle introduction to CBVs</a><ul>
<li><a class="reference internal" href="#hand-made-cbvs" id="toc-entry-2">Hand-made&nbsp;CBVs</a></li>
<li><a class="reference internal" href="#is-this-really-dry" id="toc-entry-3">Is this really <span class="caps">DRY</span>&nbsp;?</a></li>
<li><a class="reference internal" href="#re-using-view-functionality" id="toc-entry-4">Re-using view&nbsp;functionality</a></li>
<li><a class="reference internal" href="#interlude-an-mro-primer" id="toc-entry-5">Interlude: An <span class="caps">MRO</span>&nbsp;primer</a></li>
<li><a class="reference internal" href="#using-mixins-for-code-reuse" id="toc-entry-6">Using mixins for&nbsp;code-reuse</a></li>
<li><a class="reference internal" href="#the-super-situation" id="toc-entry-7">The super&nbsp;situation</a></li>
<li><a class="reference internal" href="#using-super-in-our-hierarchy" id="toc-entry-8">Using super in our&nbsp;hierarchy</a></li>
<li><a class="reference internal" href="#testing-all-this" id="toc-entry-9">Testing all&nbsp;this</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-high-level-overview-of-cbvs" id="toc-entry-10">A high level overview of CBVs</a><ul>
<li><a class="reference internal" href="#taking-a-look-at-the-view" id="toc-entry-11">Taking a look at the&nbsp;View</a></li>
<li><a class="reference internal" href="#redirectview-and-templateview" id="toc-entry-12">RedirectView and&nbsp;TemplateView</a></li>
<li><a class="reference internal" href="#the-formview" id="toc-entry-13">The&nbsp;FormView</a></li>
<li><a class="reference internal" href="#the-listview-and-detailview" id="toc-entry-14">The ListView and&nbsp;DetailView</a></li>
<li><a class="reference internal" href="#the-createview" id="toc-entry-15">The&nbsp;CreateView</a></li>
<li><a class="reference internal" href="#the-updateview-and-deleteview" id="toc-entry-16">The UpdateView and&nbsp;DeleteView</a></li>
<li><a class="reference internal" href="#access-control-mixins" id="toc-entry-17">Access control&nbsp;mixins</a></li>
<li><a class="reference internal" href="#some-other-cbvs" id="toc-entry-18">Some other&nbsp;CBVs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#real-world-use-cases" id="toc-entry-19">Real world use cases</a><ul>
<li><a class="reference internal" href="#do-something-when-a-valid-form-is-submitted" id="toc-entry-20">Do something when a valid form is&nbsp;submitted</a></li>
<li><a class="reference internal" href="#change-the-queryset-of-the-cbv" id="toc-entry-21">Change the queryset of the <span class="caps">CBV</span></a></li>
<li><a class="reference internal" href="#allow-each-user-to-list-view-edit-delete-only-his-own-items" id="toc-entry-22">Allow each user to list/view/edit/delete only his own&nbsp;items</a></li>
<li><a class="reference internal" href="#configure-the-form-s-initial-values-from-get-parameters" id="toc-entry-23">Configure the form&#8217;s initial values from <span class="caps">GET</span>&nbsp;parameters</a></li>
<li><a class="reference internal" href="#pass-extra-kwargs-to-the-formview-form" id="toc-entry-24">Pass extra kwargs to the FormView&nbsp;form</a></li>
<li><a class="reference internal" href="#add-values-to-the-context" id="toc-entry-25">Add values to the&nbsp;context</a></li>
<li><a class="reference internal" href="#add-a-simple-filter-to-a-listview" id="toc-entry-26">Add a simple filter to a&nbsp;ListView</a></li>
<li><a class="reference internal" href="#support-for-success-messages" id="toc-entry-27">Support for success&nbsp;messages</a></li>
<li><a class="reference internal" href="#implement-a-quick-moderation" id="toc-entry-28">Implement a quick&nbsp;moderation</a></li>
<li><a class="reference internal" href="#allow-access-to-a-view-if-a-user-has-one-out-of-a-group-of-permissions" id="toc-entry-29">Allow access to a view if a user has one out of a group of&nbsp;permissions</a></li>
<li><a class="reference internal" href="#disable-a-view-based-on-some-condition" id="toc-entry-30">Disable a view based on some&nbsp;condition</a></li>
<li><a class="reference internal" href="#output-non-html-views" id="toc-entry-31">Output non-html&nbsp;views</a></li>
<li><a class="reference internal" href="#use-one-templateview-for-multiple-html-templates" id="toc-entry-32">Use one TemplateView for multiple html&nbsp;templates</a></li>
<li><a class="reference internal" href="#implement-a-partial-ajax-view" id="toc-entry-33">Implement a partial Ajax&nbsp;view</a></li>
<li><a class="reference internal" href="#add-a-dynamic-filter-and-or-table-to-the-context" id="toc-entry-34">Add a dynamic filter and/or table to the&nbsp;context</a></li>
<li><a class="reference internal" href="#configure-forms-for-your-views" id="toc-entry-35">Configure forms for your&nbsp;views</a></li>
<li><a class="reference internal" href="#display-a-different-form-for-create-and-update" id="toc-entry-36">Display a different form for Create and&nbsp;Update</a></li>
<li><a class="reference internal" href="#only-allow-specific-http-methods-for-a-view" id="toc-entry-37">Only allow specific <span class="caps">HTTP</span> methods for a&nbsp;view</a></li>
<li><a class="reference internal" href="#create-an-umbrella-view-for-multiple-models" id="toc-entry-38">Create an umbrella View for multiple&nbsp;models</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-heavy-cbv-user-project" id="toc-entry-39">A heavy <span class="caps">CBV</span> user&nbsp;project</a></li>
<li><a class="reference internal" href="#conclusion" id="toc-entry-40">Conclusion</a></li>
</ul>
</div>
<p>Class Based Views (<span class="caps">CBV</span>) is one of my favourite things about Django. During my
first Django projects (using Django 1.4 around 6 years ago) I was mainly using
functional views &#8212; that&#8217;s what the tutorial recommended then anyway. However,
slowly in my next projects I started reducing the amount of functional views
and embracing CBVs, slowly understanding their usage and usefulness. Right now,
I more or less only use CBVs for my views; even if sometimes it seems more work
to use a <span class="caps">CBV</span> instead of a functional one I know that sometime in the future I&#8217;d
be glad that I did it since I&#8217;ll want to re-use some view functionality and
CBVs are more or less the only way to have <span class="caps">DRY</span> views in&nbsp;Django.</p>
<p>I&#8217;ve heard various rants about them, mainly that they are too complex and difficult to
understand and use, however I believe that they are not really difficult when
you start from the basics. Even if it is a little work to become comfortable with
the <span class="caps">CBV</span> logic, when they are used properly they will greatly improve your Django experience
so it is definitely worth&nbsp;it.</p>
<p>Notice
that to properly understand CBVs you must have a good understanding of how
Python&#8217;s (multiple) inheritance and <span class="caps">MRO</span> work. Yes, this is a rather complex and
confusing thing but I&#8217;ll try to also explain this as good as I can to the first chapter
of this article so if you follow along you shouldn&#8217;t have any&nbsp;problems.</p>
<p>This guide has four&nbsp;parts:</p>
<ul class="simple">
<li>A gentle introduction to how CBVs are working and to the the problems that do solve. For this we&#8217;ll implement
our own simple Custom Class Based View variant and take a look at python&#8217;s inheritance&nbsp;model.</li>
<li>A high level overview of the real Django CBVs using <a class="reference external" href="http://ccbv.co.uk`"><span class="caps">CBV</span> inspector</a> as our&nbsp;guide.</li>
<li>A number of use cases where CBVs can be used to elegantly solve real world&nbsp;problems</li>
<li>Describing the usage of some of the previous use cases to a real Django&nbsp;application</li>
</ul>
<p>I&#8217;ve implemented an accompanying project to this article which you can find at <a class="reference external" href="https://github.com/spapas/cbv-tutorial">https://github.com/spapas/cbv-tutorial</a>.
This project has two separate parts. One that is the implementation of the Custom Class Based View variant
to see how it is working and the other is the application that contains the usage of the various <span class="caps">CBV</span> use&nbsp;cases.</p>
<div class="section" id="a-gentle-introduction-to-cbvs">
<h2>A gentle introduction to&nbsp;CBVs</h2>
<p>In this part of the guide we&#8217;ll do a gentle introduction to how CBVs work by implementing
our own class based views variant - along with it we&#8217;ll introduce and try to understand
some concepts of  python (multiple) inheritance and how it applies to&nbsp;CBVs.</p>
<p>Before continuing, let&#8217;s talk about the concept of the &#8220;view&#8221; in Django:
Django is considered an <span class="caps">MVT</span> (Model View Template) framework - the View as
conceived by Django is not the same as the <span class="caps">MVC</span>-View. A Django View is more or
less a way to define the data that the Template (which is cloased to the <span class="caps">MVC</span>-View)
will display, so the Django View (with the help of the Django Framework) is similar
to the <span class="caps">MVC</span>-Controller.</p>
<p>In any case, traditionally a view in Django is a normal python function that takes a single parameter,
the <a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpRequest">request</a> object and must return a <a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpResponse">response</a> object (notice that if the
view uses request parameters for example the id of an object to be edited
they will also be passed to the function). The responsibility of the
view function is to properly parse the request parameters and construct the
response object - as can be understood there is a lot of work that need to be
done for each view (for example check if the method is <span class="caps">GET</span> or <span class="caps">POST</span>, if the user
has access to that page, retrieve objects from the database, crate a context dict
and pass it to the template to be rendered&nbsp;etc).</p>
<p>Now, since functional views are simple python functions it is <em>not</em> easy to override,
reuse or extend their behaviour. There are more or less two methods for this: Use function
decorators or pass extra parameters when adding the view to your urls. I&#8217;d like
to point out here that there&#8217;s a third method for code-reuse: Extracting
functionality to common and re-usable functions or classes that will be called from the
functional views but this is not something specific to Django views but a general
concept of good programming style which you should follow&nbsp;anyway.</p>
<p>The first one uses <a class="reference external" href="https://wiki.python.org/moin/PythonDecorators">python decorators</a> to create a functional view that wraps the
initial one. The new view is called before the initial one, adds some functionality
(for example check if the current user has access, modify request parameters etc),
calls the initial one which will return a response object, modify the response if needed
and then return that. This is how <a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/auth/default/#the-login-required-decorator">login_required</a> works. Notice that by using
decorators you can change things before and after the original view runs but
you can&#8217;t do anything about the way the original view&nbsp;works.</p>
<p>For the second one (adding extra view parameters) you must
write your function view in a way which allows it to be reused, for example instead
of hard-coding the template name allow it to be passed as a parameter or instead
of using a specific form class for a form make it configurable through a parameter. Then,
when you add this function to your urls you will pass different parameters
depending on how you want to configure your view. Using this method you can
override the original function behaviour however there&#8217;s a limit to the number of
parameters you can allow your function views to have and notice that these
function views cannot be further overridden. The <a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/auth/default/#django.contrib.auth.views.login">login</a> authentication view (which
is now deprecated in favour of a <span class="caps">CBV</span> one)
is using this technique, for example you can pass it
the template name that will be used, a custom authentication form&nbsp;etc.</p>
<p>It should be obvious that both these methods have severe limitations and do not allow you to be as <span class="caps">DRY</span> as
you should be. When using the wrapped views you can&#8217;t actually
change the functionality of the original view (since that original function needs
to be called) but only do things before and after calling it. Also, using the
parameters will lead to spaghetti code with multiple if / else conditions in order
to take into account the various cases that may arise. All the above lead to
very reduced re-usability and DRYness of functional views - usually the best thing
you can do is to gather the common things in external normal python functions (not view functions) that could be
re-used from other functional views as already&nbsp;discussed.</p>
<p>Class based views solve the above problem of non-<span class="caps">DRY</span>-ness by using the well known
concept of <span class="caps">OO</span> inheritance: The view is defined from a class which has methods
for implementing the view functionality - you inherit from that class and override
the parts you want so the inherited class based view will use the overridden methods instead
of the original ones. You can also create re-usable classes (mixins) that offer a specific
functionality to your class based view by implementing some of the methods of the
original class. Each one of your class based views can inherit its functionality from
multiple mixins thus allowing you to define a single class for each thing you need
and re-using it everywhere. Notice of course that this is possible only if the
CBVs are <em>properly implemented</em> to allow overriding their functionality. We&#8217;ll see
how this is possible in the next&nbsp;section.</p>
<div class="section" id="hand-made-cbvs">
<h3>Hand-made&nbsp;CBVs</h3>
<p>To make things more clear we&#8217;ll start implementing our own class based views hierarchy. Here&#8217;s
a rather naive first&nbsp;try:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CustomClassView</span><span class="p">:</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;html&gt;</span>
<span class="s2">                &lt;body&gt;</span>
<span class="s2">                    &lt;h1&gt;</span><span class="si">{header}</span><span class="s2">&lt;/h1&gt;</span>
<span class="s2">                    </span><span class="si">{body}</span>
<span class="s2">                &lt;/body&gt;</span>
<span class="s2">            &lt;/html&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="s1">&#39;&lt;br /&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">as_view</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="p">):</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">view</span>
</pre></div>
<p>This class can be used to render a simple <span class="caps">HTML</span> template with a custom header and
a list of items in the body (named <tt class="docutils literal">context</tt>). There are two things to notice here: The <tt class="docutils literal">__init__</tt> method (which
will be called as the object&#8217;s constructor) will assign all the keyword arguments (<tt class="docutils literal">kwargs</tt>) it receives
as instance attributes (for example <tt class="docutils literal"><span class="pre">CustomClassView(header='hello')</span></tt> will create
an instance with <tt class="docutils literal">'hello'</tt> as its <tt class="docutils literal">header</tt> attribute). The <tt class="docutils literal">as_view</tt> is a class method
(i.e it can be called directly on the <em>class</em> without the need to instantiate an object
for example you can call <tt class="docutils literal">CustomClassView.as_view()</tt> ) that
defines and returns a traditional functional view (named <tt class="docutils literal">view</tt>) that will be used to
actually serve the view. The returned
functional view is very simple - it just instantiates a new instance (object)
of <tt class="docutils literal">CustomClassView</tt> passing
the <tt class="docutils literal">kwargs</tt> it got in the constructor and then returns a normal <tt class="docutils literal">HttpResponse</tt> with
the instance&#8217;s <tt class="docutils literal">render()</tt> result. This <tt class="docutils literal">render()</tt> method will just output some html
using the instance&#8217;s header and context to fill&nbsp;it.</p>
<p>Notice that the instance of the <tt class="docutils literal">CustomClassView</tt> inside the <tt class="docutils literal">as_view</tt> class method
is not created using
<tt class="docutils literal"><span class="pre">CustomClassView(**kwargs)</span></tt> but using <tt class="docutils literal"><span class="pre">cls(**kwargs)</span></tt> - <tt class="docutils literal">cls</tt> is the name of the
class that <tt class="docutils literal">as_view</tt> was called on and is actually passed as a parameter for
class methods (in a similar manner to how <tt class="docutils literal">self</tt> is passed to instance methods).
This is important to instantiate an object instance of the proper&nbsp;class.</p>
<p>For example, if you created a class that inherited from <tt class="docutils literal">CustomClassView</tt>
and called its <tt class="docutils literal">as_view</tt> method then when you use the <tt class="docutils literal">cls</tt> parameter to instantiate
the object it will correctly create an object of the <em>inherited</em> class and not the <em>base</em> one
(if on the other hand you had used <tt class="docutils literal"><span class="pre">CustomClassView(**kwargs)</span></tt> to instantiate the instance
then the <tt class="docutils literal">as_view</tt> method of the inheriting classes would instantiate instances of
<tt class="docutils literal">CustomClassView</tt> so inheritance wouldn&#8217;t really&nbsp;work!).</p>
<p>To add the above class method in your urls, just use its <tt class="docutils literal">as_view()</tt> as you&#8217;d
normally use a functional&nbsp;view:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^ccv-empty/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">CustomClassView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ccv-empty&#39;</span><span class="p">),</span>
    <span class="c1"># ... other urls</span>
<span class="p">]</span>
</pre></div>
<p>This doesn&#8217;t actually render anything since both header and context are empty on
the created instance &#8212; remember that <tt class="docutils literal">as_view</tt> returns a functional view that
instantiates a <tt class="docutils literal">CustomClassView</tt> object and returns an <tt class="docutils literal">HttpResponse</tt> filling it
with the object&#8217;s <tt class="docutils literal">render()</tt> results. To add some output we can either
create another class that inherits from <tt class="docutils literal">CustomClassView</tt> or
initialize the attributes from the constructor of the class (using the kwargs functionality described&nbsp;above).</p>
<p>The inherited class can just override the values of the&nbsp;attributes:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">InheritsCustomClassView</span><span class="p">(</span><span class="n">CustomClassView</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;Hi&quot;</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;test2&#39;</span> <span class="p">]</span>
</pre></div>
<p>And then just add the inherited class to your urls as&nbsp;before:</p>
<div class="highlight"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^ccv-inherits/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">InheritsCustomClassView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ccv-inherits&#39;</span><span class="p">),</span>
</pre></div>
<p>The <tt class="docutils literal">as_view()</tt> method will create an instance of <tt class="docutils literal">InheritsCustomClassView</tt> that has
the values configured in the class as attributes and return
its <tt class="docutils literal">render()</tt> output as&nbsp;response.</p>
<p>The other way to configure the attributes of the class is to
pass them to the <tt class="docutils literal">as_view</tt> class method (which in turn will pass them to the instances
constructor which will set the attributes in the instance). Here&#8217;s an&nbsp;example:</p>
<div class="highlight"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^ccv-with-values/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">CustomClassView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">,</span> <span class="p">],</span> <span class="n">footer</span><span class="o">=</span><span class="s1">&#39;Bye&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ccv-with-values&#39;</span><span class="p">),</span>
</pre></div>
<p>The above will create a <tt class="docutils literal">CustomClassView</tt> instance with the provided values as its&nbsp;attributes.</p>
<p>Although this method of configuration is used in normal django CBVs (for example
setting the <tt class="docutils literal">template_name</tt> in a <tt class="docutils literal">TemplateView</tt>) I recommend you avoid using it because passing parameters
to the <tt class="docutils literal">as_view</tt> method pollutes the urls.py with configuration
that (at least in my opinion) should <em>not</em> be there (and there&#8217;s no reason to have to take a look at both
your urls.py and your views.py to understand the behavior of your views) and also, even for very simple views I know that after some time I&#8217;ll need
to add some functionality that cannot be implemented by passing the parameters so I prefer to bite the
bullet and define all my views as inherited classes so it will be easy for me to further customize them later (we&#8217;ll
see how this is done in a second). Thus, even if you&nbsp;have</p>
<p>In any case, I won&#8217;t discuss passing parameters to the <tt class="docutils literal">as_view</tt> method any more,
so from now on any class based views I define will be added to urls py using <tt class="docutils literal">ClassName.as_view()</tt> without any
parameters to the <tt class="docutils literal">as_view()</tt> class&nbsp;method.</p>
</div>
<div class="section" id="is-this-really-dry">
<h3>Is this really <span class="caps">DRY</span>&nbsp;?</h3>
<p>Let&#8217;s now suppose that we wanted to allow our class based view to print something on the header even if no header is provided
when you configure it. The only way to do it would be to re-define the <tt class="docutils literal">render</tt> method like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;DEFAULT HEADER&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;html&gt;</span>
<span class="s2">            &lt;body&gt;</span>
<span class="s2">                &lt;h1&gt;</span><span class="si">{header}</span><span class="s2">&lt;/h1&gt;</span>
<span class="s2">                </span><span class="si">{body}</span>
<span class="s2">            &lt;/body&gt;</span>
<span class="s2">        &lt;/html&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="s1">&#39;&lt;br /&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
<p>This is definitely not the <span class="caps">DRY</span> way to do it because you would need to re-define the whole <tt class="docutils literal">render</tt> method. Think
what would happen if
you wanted to print <tt class="docutils literal">&quot;<span class="caps">ANOTHER</span> <span class="caps">DEFAULT</span> <span class="caps">HEADER</span>&quot;</tt> as a default header for some other view - once again re-defining
<tt class="docutils literal">render</tt>! In fact, the above
<tt class="docutils literal">CustomClassView</tt> is naively implemented because it does not allow proper customization through inheritance. The
same problems for the header arise also when you need modify the body; for
example, if you wanted to add an index number before displaying the items of the list then you&#8217;d need to again re-implement the
whole <tt class="docutils literal">render</tt> method.</p>
<p>If that was our only option then we could just stick to functional views. However, we can do
much better if we define the class based view in such a way that allows inherited classes to override methods that
define specific parts of the functionality. To do this the class-based-view must be properly implemented so each
part of its functionality is implemented by a different&nbsp;method.</p>
<p>Here&#8217;s how we could improve the <tt class="docutils literal">CustomClassView</tt> to make it more <span class="caps">DRY</span>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BetterCustomClassView</span><span class="p">(</span><span class="n">CustomClassView</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Better Custom Class View&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;br /&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;html&gt;</span>
<span class="s2">                &lt;body&gt;</span>
<span class="s2">                    &lt;h1&gt;</span><span class="si">{header}</span><span class="s2">&lt;/h1&gt;</span>
<span class="s2">                    </span><span class="si">{body}</span>
<span class="s2">                &lt;/body&gt;</span>
<span class="s2">            &lt;/html&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_header</span><span class="p">(),</span> <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">render_context</span><span class="p">(),</span>
            <span class="p">)</span>
</pre></div>
<p>So what happens here? First of all we inherit from <tt class="docutils literal">CustomClassView</tt> to keep the
<tt class="docutils literal">as_view</tt> method which doesn&#8217;t need changing. Beyond this, the render
uses methods (<tt class="docutils literal">get_header</tt> and <tt class="docutils literal">render_context</tt>) to retrieve the values from the header and the body - this means
that we could re-define these methods to an inherited class in order to override
what these methods will return. Beyond <tt class="docutils literal">get_header</tt> and <tt class="docutils literal">render_contex</tt> I&#8217;ve added
a <tt class="docutils literal">get_context</tt> method that is used by <tt class="docutils literal">render_context</tt> to make this <span class="caps">CBV</span> even
more re-usable. For example I may
need to configure the context (add/remove items from the context i.e have a <span class="caps">CBV</span>
that adds a last item with the number of list items to the list to be displayed). Of course this could
be done from <tt class="docutils literal">render_context</tt> <em>but</em> this means that I would need to define my new functionality
(modifying the context items) <em>and</em> re-defining the context list formatting. It is much
better (in my opinion always) to keep properly separated these&nbsp;things.</p>
<p>Now, the above is a first try that I created to mainly fulfil my requirement of
having a default header and some more examples I will discuss later (and keep
everything simple enough). You could
extract more functionality as methods-for-overriding, for example the render
method could be written like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_template</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_header</span><span class="p">(),</span> <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">render_context</span><span class="p">(),</span>
        <span class="p">)</span>
</pre></div>
<p>and add a <tt class="docutils literal">get_template</tt> method that will return the actual html template. There&#8217;s no
hard rules here on what functionality should be extracted to a method (so it could
be overridden) however I recommend to follow the <span class="caps">YAGNI</span> rule (i.e implement everything
as normal and when you see that some functionality needs to be overridden then refactor
your code to extract it to a separate&nbsp;method).</p>
<p>Let&#8217;s see an example of adding the default header functionality by overriding <tt class="docutils literal">get_header</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderBetterCustomClassView</span><span class="p">(</span><span class="n">BetterCustomClassView</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;DEFAULT HEADER&quot;</span>
</pre></div>
<p>Classes inheriting from <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> can choose to not
actually define a header attribute so <tt class="docutils literal">&quot;<span class="caps">DEFAULT</span> <span class="caps">HEADER</span>&quot;</tt> will be printed instead. Keep in
mind that for <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> to be actually useful you&#8217;ll need to
have more than one classes that need this default-header functionality (or else you could
just set the header attribute of your class to <tt class="docutils literal">&quot;<span class="caps">DEFAULT</span> <span class="caps">HEADER</span>&quot;</tt> - this is not
user generated input, this is your source&nbsp;code!).</p>
</div>
<div class="section" id="re-using-view-functionality">
<h3>Re-using view&nbsp;functionality</h3>
<p>We have come now to a crucial point in this chapter, so please stick with me. Let&#8217;s say that you have
<em>more than one</em> class based views that contain a header attribute. You want to include
the default header functionality on all of them so that if any view instantiated from these
class based views doesn&#8217;t define a header
the default string will be output (I know that this may be a rather trivial example but I want
to keep everything simple to make following easy - instead of the default header the functionality
you want to override may be adding stuff to the context or filtering the objects you&#8217;ll retrieve
from the&nbsp;database).</p>
<p>To re-use this default header functionality from multiple classes you have <em>two</em> options:
Either inherit all classes that need this functionality from <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> or
extract the custom <tt class="docutils literal">get_header</tt> method to a <em>mixin</em> and inherit from the mixin. A mixin is a class not
related to the class based view hierarchy we are using - the mixin inherits from object (or from another
mixin) and just defines the methods and attributes that need to be overridden. When the mixin is <em>mixed</em>
with the ancestors of a class its functionality will be used by that class (we&#8217;ll see how shortly). So
the mixin will only define <tt class="docutils literal">get_header</tt> and not all other methods like
<tt class="docutils literal">render</tt>, <tt class="docutils literal">get_context</tt> etc. Using the
<tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> is enough for some cases but for the general case
of re-using the functionality you&#8217;ll need to create the mixin. Let&#8217;s see&nbsp;why:</p>
<p>Suppose that you have a base class that renders the header and context as <span class="caps">JSON</span> instead of the <span class="caps">HTML</span>
template, something like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">JsonCustomClassView</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">as_view</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="p">):</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_header</span><span class="p">(),</span>
                <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_context</span><span class="p">(),</span>
            <span class="p">}))</span>

        <span class="k">return</span> <span class="n">view</span>
</pre></div>
<p>Notice that this class does not inherit from our previous hierarchy (i.e does not
inherit from BetterCustomClassView) but from object since it provides
its own <tt class="docutils literal">as_view</tt> method. How could we re-use default header functionality
in this class (without having to re-implement it)? One solution would be to create a class that
inherits from both <tt class="docutils literal">JsonCustomClassView</tt> and <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> using something&nbsp;like</p>
<div class="highlight"><pre><span></span><span class="c1"># OPTION 1</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderJsonCustomClassView</span><span class="p">(</span><span class="n">DefaultHeaderBetterCustomClassView</span><span class="p">,</span> <span class="n">JsonCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1"># OR</span>
<span class="c1"># OPTION 2</span>
<span class="k">class</span><span class="w"> </span><span class="nc">JsonDefaultHeaderCustomClassView</span><span class="p">(</span><span class="n">JsonCustomClassView</span><span class="p">,</span> <span class="n">DefaultHeaderBetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>What will happen here? Notice that the methods <tt class="docutils literal">get_header</tt> and <tt class="docutils literal">as_view</tt> exist in <em>both</em> ancestor classes! So
which one will be used in each case? Actually, there&#8217;s a (rather complex) rule for that called
<span class="caps">MRO</span> (Method Resolution Order). The <span class="caps">MRO</span> is also what can be used to know which <tt class="docutils literal">get_header</tt>
and <tt class="docutils literal">as_view</tt> will be used in each case in the previous&nbsp;example.</p>
</div>
<div class="section" id="interlude-an-mro-primer">
<h3>Interlude: An <span class="caps">MRO</span>&nbsp;primer</h3>
<p>What is <span class="caps">MRO</span>? For every class that Python sees, it tries to create a <em>list</em> (<span class="caps">MRO</span> list) of ancestor classes containing that class as
the first element and its ancestors in a specific order I&#8217;ll discuss in the next paragraph. When a method
of an object of that specific class needs to be
called, then the method will be searched in the <span class="caps">MRO</span> list (from the first element of the <span class="caps">MRO</span> list i.e. starting with the class itself) - when a class is found
in the list that defines the method then that method instance (i.e. the method defined in this class) will be called and the search will stop (careful readers: I haven&#8217;t
yet talked about <em>super</em> so please be&nbsp;patient).</p>
<p>Now, how is the <span class="caps">MRO</span> list created? As I explained, the first element
is the class itself. The second element is the <span class="caps">MRO</span> of the <em>leftmost</em> ancestor of that object (so <span class="caps">MRO</span> will
run recursively on each ancestor), the third element will be the <span class="caps">MRO</span> of the ancestor right next to the leftmost
ancestor etc. There is one extra and important rule: When a class is found multiple times in the <span class="caps">MRO</span> list (for example
if some elements have a common ancestor) then <em>only the last occurrence in the list will be kept</em> - so each class
will exist only once in the <span class="caps">MRO</span> list. The above rule implies that the
rightmost element in every <span class="caps">MRO</span> list will always be object - please make sure you
understand why before&nbsp;continuing.</p>
<p>Thus, the <span class="caps">MRO</span> list for <tt class="docutils literal">DefaultHeaderJsonCustomClassView</tt> defined in the previous section
is (remember, start
with the class to the left and add the <span class="caps">MRO</span> of each of its ancestors starting
from the leftmost one):
<tt class="docutils literal">[DefaultHeaderJsonCustomClassView, DefaultHeaderBetterCustomClassView, BetterCustomClassView, CustomClassView, JsonCustomClassView, object]</tt>, while
for <tt class="docutils literal">JsonDefaultHeaderCustomClassView</tt> is
<tt class="docutils literal">[JsonDefaultHeaderCustomClassView, JsonCustomClassView, DefaultHeaderBetterCustomClassView, BetterCustomClassView, CustomClassView, object]</tt>. What this
means is that for <tt class="docutils literal">DefaultHeaderJsonCustomClassView</tt> the <tt class="docutils literal">CustomClassView.as_view()</tt> and <tt class="docutils literal">DefaultHeaderBetterCustomClassView.get_header()</tt> will be used (thus
we will not get the <span class="caps">JSON</span> output) and for <tt class="docutils literal">JsonDefaultHeaderCustomClassView</tt> the <tt class="docutils literal">JsonCustomClassView.as_view()</tt> and <tt class="docutils literal">JsonCustomClassView.get_header()</tt>
will be used (so we won&#8217;t get the default header functionality) - i.e none of those two options will result to the desired&nbsp;behaviour.</p>
<p>Let&#8217;s try an example that has the same base class twice in the hierarchy (actually the previous examples also had a class twice in
the hierarchy - <tt class="docutils literal">object</tt> but let&#8217;s be more explicit). For this, we&#8217;ll create a
<tt class="docutils literal">DefaultContextBetterCustomClassView</tt> that returns a default context if the context is empty
(similar to the default header&nbsp;functionality).</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultContextBetterCustomClassView</span><span class="p">(</span><span class="n">BetterCustomClassView</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;DEFAULT CONTEXT&quot;</span><span class="p">]</span>
</pre></div>
<p>Now we&#8217;ll create a class that inherits from both <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> and <tt class="docutils literal">DefaultContextBetterCustomClassView</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderContextCustomClassView</span><span class="p">(</span><span class="n">DefaultHeaderBetterCustomClassView</span><span class="p">,</span> <span class="n">DefaultContextBetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Let&#8217;s do the <span class="caps">MRO</span> for the <tt class="docutils literal">DefaultHeaderContextCustomClassView</tt> class:</p>
<p>Initially, the <span class="caps">MRO</span> will be the&nbsp;following:</p>
<pre class="code literal-block">
Starting with the initial class
1. DefaultHeaderContextCustomClassView
Follows the leftmost class (DefaultHeaderBetterCustomClassView) MRO
2. DefaultHeaderBetterCustomClassView, 3. BetterCustomClassView, 4. CustomClassView, 5. object
And finally the next class (DefaultContextBetterCustomClassView) MRO
6. DefaultContextBetterCustomClassView, 7. BetterCustomClassView, 8. CustomClassView, 9. object
</pre>
<p>Notice that classes <tt class="docutils literal">BetterCustomClassView</tt>, <tt class="docutils literal">CustomClassView</tt> and <tt class="docutils literal">object</tt> are repeated two times
(on place 3,4,5 and 7,8,9) thus <em>only</em> their last (rightmost) occurrences will be kept in the list. So the
resulting <span class="caps">MRO</span> is the following (3,4,5 are&nbsp;removed):</p>
<p><tt class="docutils literal">[DefaultHeaderContextCustomClassView, DefaultHeaderBetterCustomClassView, DefaultContextBetterCustomClassView, BetterCustomClassView, CustomClassView, object]</tt></p>
<p>One funny thing here is that the <tt class="docutils literal">DefaultHeaderContextCustomClassView</tt> <em>will actually work</em> properly because the
<tt class="docutils literal">get_header</tt> will be found in <tt class="docutils literal">DefaultHeaderBetterCustomClassView</tt> and the
<tt class="docutils literal">get_context</tt> will be found in <tt class="docutils literal">DefaultContextBetterCustomClassView</tt> so this
result to the correct&nbsp;functionality.</p>
<p>Yes it does work but at what cost? Do you really want to do the mental exercise
of finding out the <span class="caps">MRO</span> for each class you define to see which method will be actually used? Also, what would happen if the
<tt class="docutils literal">DefaultHeaderContextCustomClassView</tt> class also had a <tt class="docutils literal">get_context</tt> method defined
(hint: that <tt class="docutils literal">get_context</tt> would be used and the <tt class="docutils literal">get_context</tt> of <tt class="docutils literal">DefaultContextBetterCustomClassView</tt>
would be&nbsp;ignored).</p>
<p>Before finishing this interlude, I&#8217;d like to make a confession: The Python <span class="caps">MRO</span> algorithm is not as simple as
than the procedure I described. It uses an algorithm called <a class="reference external" href="https://en.wikipedia.org/wiki/C3_linearization">C3 linearization</a> which seems way too complex
to start explaining or understanding if you not a <span class="caps">CS</span> student. What you&#8217;ll need to remember is that the
procedure I described works fine in normal cases when you don&#8217;t try to do something stupid. Here&#8217;s a
<a class="reference external" href="https://medium.com/technology-nineleaps/python-method-resolution-order-4fd41d2fcc">post that explains the theory more</a>. However if you  follow along my recommendations below you won&#8217;t
have any problems with <span class="caps">MRO</span>, actually you won&#8217;t really need to use the <span class="caps">MRO</span> that much to understand
the method calling&nbsp;hierarchy.</p>
</div>
<div class="section" id="using-mixins-for-code-reuse">
<h3>Using mixins for&nbsp;code-reuse</h3>
<p>The above explanation of <span class="caps">MRO</span> should convince you that you should avoid
mixing hierarchies of classes - if you are not convinced then wait until I introduce <tt class="docutils literal">super()</tt>
in the next section and I guarantee that you&#8217;ll&nbsp;be!</p>
<p>So, that&#8217;s why I
propose implementing common functionality that needs to be re-used between
classes only with mixins (hint: that&#8217;s also what Django does). Each re-usable functionality
will be implemented in its own mixin;  class views that need to implement that
functionality will just inherit from the mixin along with the base class view. Each
one of the view classes you define should inherit from <em>one and only one</em> other class
view and any number of mixins you want. Make sure that the view class is rightmost in
the ancestors list and the mixins are to the left of it (so that they will properly override
its behaviour; remember that the methods of the ancestors to the left are searched first
in the <span class="caps">MRO</span> list &#8212; and the methods of the defined class have of course the highest priority
since it goes first in the <span class="caps">MRO</span>&nbsp;list).</p>
<p>Let&#8217;s try implementing the proposed mixins for a default header and&nbsp;context:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;DEFAULT HEADER&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DefaultContextMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;DEFAULT CONTEXT&quot;</span><span class="p">]</span>
</pre></div>
<p>and all the proposed use cases using the base class view and the&nbsp;mixins:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderMixinBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DefaultContextMixinBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">DefaultContextMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderContextMixinBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderMixin</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">DefaultContextMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">JsonDefaultHeaderMixinCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderMixin</span><span class="p">,</span> <span class="n">JsonCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>I believe that the above definitions are self-documented and it is very easy to know which
method of the resulting class will be called each time: Start from the main class and if
the method is not found there continue from left to right to the ancestor list; since the mixins
do only one thing and do it well you&#8217;ll know what each class does simply by looking at its&nbsp;definition.</p>
</div>
<div class="section" id="the-super-situation">
<h3>The super&nbsp;situation</h3>
<p>The final (and most complex) thing and extension I&#8217;d like to discuss for our custom class based views is the case
where you want to use the functionality of more than one mixins for the <em>same thing</em>. For example, let&#8217;s suppose
that we had a mixin that added some data to the context and a different mixing that added
some different data to the context. Both would use the <tt class="docutils literal">get_context</tt> method
and you&#8217;d like to have the context data of both of them to your context. But
this is not possible using the implementations above because when a
<tt class="docutils literal">get_context</tt> is found in the <span class="caps">MRO</span> list it will be called and the <span class="caps">MRO</span> search
will finish&nbsp;there!</p>
<p>So how could we add the functionality of both these mixins to a class based view? This is the same problem as
if we wanted to inherit from a mixin (or a class view) and override one of its methods
but <em>also</em> call its parent (overridden) method for example to get its output and use it as the base
of the output for the overridden method. Both these situations (re-use
functionality of two mixins with the same method or re-use functionality
from a parent method you override) are the same because what stays in the end is
the <span class="caps">MRO</span> list. For example say we we had the following base&nbsp;class</p>
<pre class="code literal-block">
class V:pass
</pre>
<p>and we wanted to override it either using mixins or by using normal&nbsp;inheritance.</p>
<p>When using mixins for example like&nbsp;this:</p>
<pre class="code literal-block">
class M1:pass
class M2:pass
class MIXIN(M2, M1, V):pass
</pre>
<p>we&#8217;ll have the following <span class="caps">MRO</span>:</p>
<pre class="code literal-block">
# MIXIN.mro()
# [MIXIN, M2, M1, V, object, ]
</pre>
<p>while when using inheritance like&nbsp;this:</p>
<pre class="code literal-block">
class M1V(V):pass
class M2M1V(M1V):pass
class INHERITANCE(M2M1V):pass
</pre>
<p>we&#8217;ll have the following <span class="caps">MRO</span>:</p>
<blockquote>
# <span class="caps">INHERITANCE</span>.mro()
# [<span class="caps">INHERITANCE</span>, <span class="caps">M2M1V</span>, <span class="caps">M1V</span>, V, object ]</blockquote>
<p>As we can see in both cases the base class V is the last one (just next to object)
and between this class and the one that needs the functionality (<tt class="docutils literal"><span class="caps">MIXIN</span></tt> in the first
case and <tt class="docutils literal"><span class="caps">INHERITANCE</span></tt> in the second case) there are
the classes that will define the extra functionality that needs to be re-used: <tt class="docutils literal">M2</tt> and <tt class="docutils literal">M1</tt> (start from
left to right) in the first case and <tt class="docutils literal"><span class="caps">M2M1V</span></tt> and <tt class="docutils literal"><span class="caps">M1V</span></tt> (follow the inheritance hierarchy)
in the second case. So in both cases when calling a method they will be searched the same way using
the <span class="caps">MRO</span> list and when the method is found it will be executed and the search will&nbsp;stop.</p>
<p>But what if we needed to re-use some method from <tt class="docutils literal">V</tt> (or from some other ancestor) and
a class on the left of the <span class="caps">MRO</span> list has the same method?
The answer, as you should have guessed by now if you have some Python knowledge is <tt class="docutils literal">super()</tt>.</p>
<p>The <tt class="docutils literal">super</tt> method can be used by a class method to call a method of <em>its ancestors</em> respecting
the <span class="caps">MRO</span>. Thus, running <tt class="docutils literal"><span class="pre">super().x()</span></tt> from a method instance will try to find method <tt class="docutils literal">x()</tt>
on the <span class="caps">MRO</span> ancestors of this instance <em>even if the instance defines the &#8220;x()&#8220; method</em> i.e it will
not search the first element of the <span class="caps">MRO</span> list. Notice
that if the <tt class="docutils literal">x()</tt> method does not exist in the headless-<span class="caps">MRO</span> chain you&#8217;ll get an attribute error.
So, usually, you&#8217;ll can <tt class="docutils literal"><span class="pre">super().x()</span></tt> from <em>inside</em> the <tt class="docutils literal">x()</tt> method to call your parent&#8217;s (as
specified by the <span class="caps">MRO</span> list) same-named method and retrieve its&nbsp;output.</p>
<p>Let&#8217;s take a closer look at how <tt class="docutils literal">super()</tt> works using a simple example. For this, we&#8217;ll define a method calld <tt class="docutils literal">x()</tt> on all classes
of the previous&nbsp;example:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">V</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From V&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">M1</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From M1&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">M2</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From M2&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MIXIN</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From MIXIN&quot;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">M1V</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From M1V&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">M2M1V</span><span class="p">(</span><span class="n">M1V</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From M2M1V&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">INHERITANCE</span><span class="p">(</span><span class="n">M2M1V</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;From INHERITANCE&quot;</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;MIXIN OUTPUT&quot;</span><span class="p">)</span>
<span class="n">MIXIN</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;INHERITANCE OUTPUT&quot;</span><span class="p">)</span>
<span class="n">INHERITANCE</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
</pre></div>
<p>Here&#8217;s the&nbsp;output:</p>
<pre class="code literal-block">
MIXIN OUTPUT
From V
From M1
From M2
From MIXIN
INHERITANCE OUTPUT
From V
From M1V
From M2M1V
From INHERITANCE
</pre>
<p>Notice when each message is printed: Because x() first calls its <tt class="docutils literal">super()</tt> method
and then it prints the message in both cases first the <tt class="docutils literal">From V</tt> message is printed
from the base class and then from the following classes in the hierarchy (as per the <span class="caps">MRO</span>)
ending with the class of the instance (either <tt class="docutils literal"><span class="caps">MIXIN</span></tt> or <tt class="docutils literal"><span class="caps">INHERITANCE</span></tt>). Also the
print order is the same in both cases as we&#8217;ve already explained. Please make
sure you understand why the output is like this before&nbsp;continuing.</p>
</div>
<div class="section" id="using-super-in-our-hierarchy">
<h3>Using super in our&nbsp;hierarchy</h3>
<p>Using super and mixins it is easy to mix and match functionality to create new
classes. Of course, super can be used without mixins when overriding a method from
a class you inherit from and want to also call your ancestor&#8217;s&nbsp;method.</p>
<p>Here&#8217;s how we could add a prefix to the&nbsp;header:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HeaderPrefixMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;PREFIX: &quot;</span> <span class="o">+</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_header</span><span class="p">()</span>
</pre></div>
<p>and here&#8217;s how it could be&nbsp;used:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HeaderPrefixBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">HeaderPrefixMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="n">header</span><span class="o">=</span><span class="s1">&#39;Hello!&#39;</span>
</pre></div>
<p>This will retrieve the header from the ancestor and properly print the header displaying both <span class="caps">PREFIX</span> and Hello.
What if we wanted to re-use the default header mixin? First let&#8217;s change <tt class="docutils literal">DefaultHeaderMixin</tt>
to properly use <tt class="docutils literal">super()</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderSuperMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_header</span><span class="p">()</span> <span class="k">if</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_header</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;DEFAULT HEADER&quot;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HeaderPrefixDefaultBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">HeaderPrefixMixin</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderSuperMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Notice the order of the ancestor classes. The <tt class="docutils literal">get_header()</tt> of  <tt class="docutils literal">HeaderPrefixMixin</tt> will be called which
will call the <tt class="docutils literal">get_header()</tt> of
<tt class="docutils literal">DefaultHeaderSuperMixin</tt> (which will call the <tt class="docutils literal">get_header()</tt> of <tt class="docutils literal">BetterCustomClassView</tt> returning <tt class="docutils literal">None</tt>).
So the result will be <tt class="docutils literal">&quot;<span class="caps">PREFIX</span>: <span class="caps">DEFAULT</span> <span class="caps">HEADER</span>&quot;</tt>. However if instead we had defined this class&nbsp;like</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HeaderPrefixDefaultBetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderSuperMixin</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">HeaderPrefixMixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>the result would be <tt class="docutils literal">&quot;<span class="caps">PREFIX</span>: &quot;</tt> (<span class="caps">DEFAULT</span> <span class="caps">HEADER</span> won&#8217;t be printed). Can you understand&nbsp;why?</p>
<p>One thing to keep in mind is that most probably you&#8217;ll need to call <tt class="docutils literal">super()</tt> and return its output when you override a method.
Even if you think that you don&#8217;t need to call it for this view or mixin, you may need it later from some other view or mixin that
inherits from this view. Also notice that <tt class="docutils literal">super()</tt> may not return anything but may have some
side-effects in your class (for example set a <tt class="docutils literal">self</tt> attribute) which you won&#8217;t get if you don&#8217;t call&nbsp;it!</p>
<p>For another example of super, let&#8217;s define a couple of mixins that add things to the&nbsp;context:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExtraContext1Mixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;data1&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctx</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ExtraContext2Mixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctx</span>
</pre></div>
<p>The first one retrieves the ancestor context list and appends <tt class="docutils literal">'data1'</tt> to the
it while the second one will insert <tt class="docutils literal">'data2'</tt> to the start of the list. To use
these mixins just add them to the ancestor list of your class hierarchy as usually.
One interesting thing to notice here is that because of how <tt class="docutils literal">get_context</tt> is
defined we&#8217;ll get the same output no matter the order of the mixins in the hierarchy
since <tt class="docutils literal">ExtraContext1Mixin</tt> will append <tt class="docutils literal">data1</tt> to the end of the context list and
the <tt class="docutils literal">ExtraContext2Mixin</tt> will insert <tt class="docutils literal">data2</tt> to the start of the context&nbsp;list.</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExtraContext12BetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext1Mixin</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext2Mixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ExtraContext21BetterCustomClassView</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext2Mixin</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext1Mixin</span><span class="p">,</span> <span class="n">BetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>If instead both of these mixins appended the item to the end of the list, then
the output would be different depending on the ancestor order.
Of course, since we&#8217;ve already defined <tt class="docutils literal">HeaderPrefixMixin</tt> and <tt class="docutils literal">DefaultHeaderSuperMixin</tt> nothing stops us
from using all those mixins&nbsp;together!</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AllTogetherNowBetterCustomClassView</span><span class="p">(</span>
        <span class="n">mixins</span><span class="o">.</span><span class="n">HeaderPrefixMixin</span><span class="p">,</span>
        <span class="n">mixins</span><span class="o">.</span><span class="n">DefaultHeaderSuperMixin</span><span class="p">,</span>
        <span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext1Mixin</span><span class="p">,</span>
        <span class="n">mixins</span><span class="o">.</span><span class="n">ExtraContext2Mixin</span><span class="p">,</span>
        <span class="n">BetterCustomClassView</span>
    <span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>This will have the desired behaviour of adding a prefix to the header, having a default header if not one was defined
and adding the extra context from both&nbsp;mixins!</p>
</div>
<div class="section" id="testing-all-this">
<h3>Testing all&nbsp;this</h3>
<p>In the accompanying project at <a class="reference external" href="https://github.com/spapas/cbv-tutorial">https://github.com/spapas/cbv-tutorial</a> you can take a look at how this
custom <span class="caps">CBV</span> hierarchy works by running it and taking a look at the <tt class="docutils literal">core</tt> project (visit <a class="reference external" href="http://127.0.0.1:8001/non-django-cbv/">http://127.0.0.1:8001/non-django-cbv/</a>).
There you can take a look at the views.py and mixins.py to see all the views and mixins we&#8217;ve discussed in this&nbsp;chapter.</p>
</div>
</div>
<div class="section" id="a-high-level-overview-of-cbvs">
<h2>A high level overview of&nbsp;CBVs</h2>
<p>After the previous rather long (but I hope gentle enough) introduction to implementing
our own class based view hierarchy using inheritance, mixins, <span class="caps">MRO</span>, method overriding
and <tt class="docutils literal">super</tt> we can now start talking about the Django Class Based Views (CBVs). Our
guide will be the <a class="reference external" href="http://ccbv.co.uk`"><span class="caps">CBV</span> inspector</a> application which displays all classes and mixins
that Django CBVs are using along with their methods and attributes. Using this application
and after reading this article you should be able to quickly and definitely know
which method or attribute you need to define to each one of your mixins or&nbsp;views.</p>
<p>To use <span class="caps">CBV</span> inspector, just click on a class name (for example <tt class="docutils literal">CreateView</tt>); you will
immediately see its <span class="caps">MRO</span> ancestors, its list of attributes (and the ancestor class that defines
each one) and finally a list of methods that this class and all its ancestors define.
Of course when a method is defined by multiple classes the <span class="caps">MRO</span> ordering will be used -
super is used when the functionality of the ancestor classes is also used. The <span class="caps">CBV</span>
inspector (and our project) has Python 3 syntax. If you want to follow along with
Python 2 (I don&#8217;t recommend it though since Django 2.0 only supports Python 3.x) use the following
syntax to call super for method <tt class="docutils literal">x()</tt>:</p>
<div class="highlight"><pre><span></span><span class="nb">super</span><span class="p">(</span><span class="n">ClassName</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
</pre></div>
<p>this is the same as&nbsp;calling</p>
<div class="highlight"><pre><span></span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
</pre></div>
<p>in Python&nbsp;3.x.</p>
<div class="section" id="taking-a-look-at-the-view">
<h3>Taking a look at the&nbsp;View</h3>
<p>In any case, our travel starts from the central <span class="caps">CBV</span> class which is (intuitively) called &#8230; <a class="reference external" href="https://ccbv.co.uk/View">View</a>!</p>
<p>This class is used as the base in Django&#8217;s <span class="caps">CBV</span> hierarchy (similar to how  <tt class="docutils literal">CustomClassView</tt>
was used in our own hierarchy). It has only one attribute
(<tt class="docutils literal">http_method_names</tt>) and a very small number of methods. The most important method is the
<tt class="docutils literal">as_view</tt> class method (which is similar to the one we defined in the previous section).
The <tt class="docutils literal">as_view</tt> will instantiate an instance object of the <tt class="docutils literal">View</tt> class
(actually the class that inherits from <tt class="docutils literal">View</tt>) and use this object to properly generate a functional&nbsp;view.</p>
<p>The <tt class="docutils literal">View</tt> class cannot be used as it is
but it must be inherited by a child class. The child class needs to define a method
that has the same name as each http method that is supported - for example if
only <span class="caps">HTTP</span> <span class="caps">GET</span> and <span class="caps">HTTP</span> <span class="caps">POST</span> are supported then the inherited class must define a
<tt class="docutils literal">get</tt> and a <tt class="docutils literal">post</tt> method; these methods are called from the functional view
through a method called <tt class="docutils literal">dispatch</tt> and need to return a proper response object. So,
we have two central methods here: The <tt class="docutils literal">as_view</tt> class method that creates the
object instance and returns its view function and <tt class="docutils literal">dispatch</tt> that will call
the proper named class method depending on the <span class="caps">HTTP</span> method (i.e post, get, put
etc). One thing to keep from this discussion is that you shouldn&#8217;t ever need to
mess with <tt class="docutils literal">as_view</tt> but, because <tt class="docutils literal">dispatch</tt> is the only instance method that is
guaranteed to run every time the class based view will run, you will frequently
need to override it especially to control access&nbsp;control.</p>
<p>As an example, we can implemented the <tt class="docutils literal">BetterCustomClassView</tt> from the first
section using <tt class="docutils literal">View</tt> as its&nbsp;ancestor:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DjangoBetterCustomClassView</span><span class="p">(</span><span class="n">View</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">context</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;br /&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;html&gt;</span>
<span class="s2">                &lt;body&gt;</span>
<span class="s2">                    &lt;h1&gt;</span><span class="si">{header}</span><span class="s2">&lt;/h1&gt;</span>
<span class="s2">                    </span><span class="si">{body}</span>
<span class="s2">                &lt;/body&gt;</span>
<span class="s2">            &lt;/html&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_header</span><span class="p">(),</span> <span class="n">body</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">render_context</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
</pre></div>
<p>This method won&#8217;t print anything but of course it could use the mixins from
before to have some default&nbsp;values:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DefaultHeaderContextDjangoBetterCustomClassView</span><span class="p">(</span><span class="n">DefaultHeaderMixin</span><span class="p">,</span> <span class="n">DefaultContextMixin</span><span class="p">,</span> <span class="n">DjangoBetterCustomClassView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Of course instead of using our mixins and render methods it would be much better
to use the proper ones defined by Django - that&#8217;s what we&#8217;re going to do from
now on I just wanted to make clear that there&#8217;s nothing special in Django&#8217;s <span class="caps">CBV</span>
hierarchy and can be overridden as we&#8217;d&nbsp;like.</p>
</div>
<div class="section" id="redirectview-and-templateview">
<h3>RedirectView and&nbsp;TemplateView</h3>
<p>Continuing our tour of Django CBVs I&#8217;d like to talk a little about the classes
that the <span class="caps">CBV</span> Inspector puts in the same level as <tt class="docutils literal">View</tt> (<span class="caps">GENERIC</span> <span class="caps">BASE</span>):
<a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/base/#redirectview">RedirectView</a> and <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/base/#templateview">TemplateView</a>. Both inherit directly from <tt class="docutils literal">View</tt> and, the
first one defines a <tt class="docutils literal">get</tt> method that returns a redirect to another page
while the latter one renders and returns a Django template in the <tt class="docutils literal">get</tt>
method.</p>
<p>The <tt class="docutils literal">RedirectView</tt> inherits directly from view and has attributes like <tt class="docutils literal">url</tt>
(to use a static url)
or <tt class="docutils literal">pattern_name</tt> (to use one of the patterns define in your urls.py)
to define where it should redirect. These attributes are
used by the <tt class="docutils literal">get_redirect_url</tt> which will generate the actual url to redirect
to and can be overriden for example to redirect to a different location depending
on the current&nbsp;user.</p>
<p>The <tt class="docutils literal">TemplateView</tt> on the other hand inherits from <tt class="docutils literal">View</tt> and two more classes (actually
these are mixins) beyond <tt class="docutils literal">View</tt>: <tt class="docutils literal">TemplateResponseMixin</tt> and
<tt class="docutils literal">ContextMixin</tt>. If you take a look at them you&#8217;ll see that the
<tt class="docutils literal">TemplateResponseMixin</tt> defines some template-related attributes (most important being
the <tt class="docutils literal">template_name</tt>) and two
methods: One that retrieves the template that will be used to render this View
(<tt class="docutils literal">get_template_names</tt>)
and one that actually renders the template (<tt class="docutils literal">render_to_response</tt>) using a
<a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/template-response/#django.template.response.TemplateResponse">TemplateResponse</a> instance. The
<tt class="docutils literal">ContextMixin</tt> provides the <tt class="docutils literal">get_context_data</tt> that is
passed to the template to be rendered and should be overridden if you want to
pass more context&nbsp;variables.</p>
<p>We can already see many opportunities of reusing and overriding
functionality and improving our <span class="caps">DRY</span> score, for example: Create a catch all RedirectView
that depending on the remainder of the url it will redirect to a different page,
create a mixin that appends some things to the context of all CBVs using it, use dynamic templates
based on some other condition (that&#8217;s actually what Detail/List/UpdateView
are doing), render a template to a different output than Html (for example a
text file) etc. I&#8217;ll try to present examples for these in the next&nbsp;section.</p>
</div>
<div class="section" id="the-formview">
<h3>The&nbsp;FormView</h3>
<p>The next view we&#8217;re going to talk about is <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-editing/#formview">FormView</a>. This is a view that can be
used whenever we want to display a form (<em>not</em> a form related to a Model i.e for
Create/Update/Delete, for these cases there are specific CBVs we&#8217;ll see later).
It is interesting to take a look at the list of its
ancestors: <tt class="docutils literal">TemplateResponseMixin</tt>, <tt class="docutils literal">BaseFormView</tt>, <tt class="docutils literal">FormMixin</tt>, <tt class="docutils literal">ContextMixin</tt>, <tt class="docutils literal">ProcessFormView</tt> and <tt class="docutils literal">View</tt>.
We are familiar with <tt class="docutils literal">TemplateResponseMixin</tt>, <tt class="docutils literal">ContextMixin</tt> and <tt class="docutils literal">View</tt> but not with
the others. Before discussing these classes let&#8217;s take a look at the FormView
hierarchy, courtesy of <a class="reference external" href="http://ccbv.co.uk">http://ccbv.co.uk</a> and <a class="reference external" href="http://yuml.me">http://yuml.me</a>:</p>
<img src="https://yuml.me/diagram/plain;/class/[TemplateResponseMixin%7Bbg:white%7D]%5E-[FormView%7Bbg:green%7D],%20[BaseFormView%7Bbg:white%7D]%5E-[FormView%7Bbg:green%7D],%20[FormMixin%7Bbg:white%7D]%5E-[BaseFormView%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[FormMixin%7Bbg:white%7D],%20[ProcessFormView%7Bbg:white%7D]%5E-[BaseFormView%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[ProcessFormView%7Bbg:white%7D].svg" alt="FormView"><p>The above diagram should make everything easier: The <tt class="docutils literal">FormMixin</tt> inherits
from <tt class="docutils literal">ContextMixin</tt> and overrides its <tt class="docutils literal">get_context_data</tt> method to add the
form to the view. Beyond this, it adds some attributes and methods for proper form handling, for
example the <tt class="docutils literal">form_class</tt> (attribute when the form class will be the same always) and
<tt class="docutils literal">get_form_class()</tt> (method when the form class will be dynamic for example
depending on the logged in user), <tt class="docutils literal">initial</tt> and <tt class="docutils literal">get_initial()</tt> (same logic as before for
the form&#8217;s initial values), <tt class="docutils literal">form_valid()</tt> and <tt class="docutils literal">form_invalid()</tt> to define
what should happen when the form is valid or invalid, <tt class="docutils literal">get_form_kwargs</tt> to pass
some keyword arguments to the form&#8217;s constructor etc. Notice that FormMixin
does not define any form handling logic (i.e check if the form is valid and call
its <tt class="docutils literal">form_valid()</tt> method) &#8212; this logic is defined in the <tt class="docutils literal">ProcessFormView</tt>
which inherits from <tt class="docutils literal">View</tt> and defines proper <tt class="docutils literal">get()</tt> (just render the form)
and <tt class="docutils literal">post()</tt> (check if the form is valid and call <tt class="docutils literal">form_valid</tt> else call <tt class="docutils literal">form_invalid</tt>)&nbsp;methods.</p>
<p>One interesting here is to notice here is that Django defines both the <tt class="docutils literal">FormMixin</tt> and <tt class="docutils literal">ProcessFormView</tt>.
The <tt class="docutils literal">FormMixin</tt> offers the basic Form elements (the form class, initial data
etc) and could be re-used in a different flow beyond the one offered by
<tt class="docutils literal">ProcessFormView</tt> (for example display the form as a <span class="caps">JSON</span> object instead of a
Django template). On the other hand, <tt class="docutils literal">ProcessFormView</tt> is required in order to
define the <tt class="docutils literal">get</tt> and <tt class="docutils literal">post</tt> methods that are needed from the <tt class="docutils literal">View</tt>. These
methods can&#8217;t be overridden in the FormMixin since that would mean that the mixin
would behave as a&nbsp;view!</p>
<p>Finally, the <tt class="docutils literal">BaseFormView</tt> class is used to
inherit from <tt class="docutils literal">ProcessFormView</tt> and <tt class="docutils literal">FormMixin</tt>. It does not do anything
more than providing a base class that other classes that want to use the form
functionality (i.e both the <tt class="docutils literal">ProcessFormView</tt> and <tt class="docutils literal">FormMixin</tt>) will inherit&nbsp;from.</p>
</div>
<div class="section" id="the-listview-and-detailview">
<h3>The ListView and&nbsp;DetailView</h3>
<p>Next in our Django <span class="caps">CBV</span> tour is the <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#listview">ListView</a>. The <tt class="docutils literal">ListView</tt> is used to render multiple
objects in a template, for example in a list or table. Here&#8217;s a diagram of the class
hierarchy (courtesy of <a class="reference external" href="http://ccbv.co.uk">http://ccbv.co.uk</a> and <a class="reference external" href="http://yuml.me">http://yuml.me</a>):</p>
<img src="https://yuml.me/diagram/plain;/class/[MultipleObjectTemplateResponseMixin%7Bbg:white%7D]%5E-[ListView%7Bbg:green%7D],%20[TemplateResponseMixin%7Bbg:white%7D]%5E-[MultipleObjectTemplateResponseMixin%7Bbg:white%7D],%20[BaseListView%7Bbg:white%7D]%5E-[ListView%7Bbg:green%7D],%20[MultipleObjectMixin%7Bbg:white%7D]%5E-[BaseListView%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[MultipleObjectMixin%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[BaseListView%7Bbg:white%7D].svg" alt="ListView"><p>The <tt class="docutils literal">MultipleObjectMixin</tt> is used make a query to the database (either using a
model or a queryset) and pass the results to the context. It also supports
custom ordering (<tt class="docutils literal">get_ordering()</tt>) and pagination (<tt class="docutils literal">paginate_queryset()</tt>).
However, the most important method of this mixin is <tt class="docutils literal">get_queryset()</tt>. This
method checks to see if the <tt class="docutils literal">queryset</tt> or <tt class="docutils literal">model</tt> attribute are defined
(<tt class="docutils literal">queryset</tt> will be checked first so it has priority if both are defined) and
returns a queryset result (taking into account the ordering). This queryset
result will be used by the <tt class="docutils literal">get_context_data()</tt> method of this mixin to
actually put it to the context by saving to a context variable named <tt class="docutils literal">object_list</tt>.
Notice that you can set the <tt class="docutils literal">context_object_name</tt> attribute to add and extra
another variable to the context with the queryset beyond <tt class="docutils literal">object_list</tt> (for
example if you have an <tt class="docutils literal">ArticleLsitView</tt> you can set <tt class="docutils literal">context_object_name = articles</tt> to
be able to do <tt class="docutils literal">{% for article in articles %}</tt> in your context instead of
<tt class="docutils literal">{% for article in object_list %}</tt>).</p>
<p>The <tt class="docutils literal">MultipleObjectMixin</tt> can be used and
overridden when we need to put multiple objects in a View. This mixin is
inherited (along with <tt class="docutils literal">View</tt>) from <tt class="docutils literal">BaseListView</tt> that adds a proper <tt class="docutils literal">get</tt>
method to call <tt class="docutils literal">get_context_data</tt> and pass the result to the&nbsp;template.</p>
<p>As we can also see, Django uses the <tt class="docutils literal">MultipleObjectTemplateResponseMixin</tt> that
inherits from <tt class="docutils literal">TemplateResponseMixin</tt> to render the template. This mixin does
some magic with the queryset or model to define a
template name (so you won&#8217;t need to define it yourself) - that&#8217;s from where the
<tt class="docutils literal">app_label/app_model_list.html</tt> default template name is&nbsp;created.</p>
<p>Similar to the <tt class="docutils literal">ListView</tt> is the <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#detailview">DetailView</a> which has the same class hierarchy as the <tt class="docutils literal">ListView</tt> with two differences:
It uses <tt class="docutils literal">SingleObjectMixin</tt> instead of <tt class="docutils literal">MultipleOjbectMixin</tt>,
<tt class="docutils literal">SingleObjectTemplateResponseMixin</tt> instead of <tt class="docutils literal">MultipleObjectTemplateResponseMixin</tt>
and <tt class="docutils literal">BaseDetailView</tt> instead of <tt class="docutils literal">BaseListView</tt>. The
<tt class="docutils literal">SingleObjectMixin</tt> will use the <tt class="docutils literal">get_queryset()</tt> (in a similar manner to the <tt class="docutils literal">get_queryset()</tt> of
<tt class="docutils literal">MultipleObjectMixin</tt>) method to return a single object (so all attributes and methods
concerning ordering or pagination are missing) but instead has the <tt class="docutils literal">get_object()</tt> method which
will pick and return a single object from that queryset (using a <tt class="docutils literal">pk</tt> or <tt class="docutils literal">slug</tt> parameter). This object
will be put to the context of this view by the <tt class="docutils literal">get_context_data</tt>. The <tt class="docutils literal">BaseDetailView</tt> just
defines a proper <tt class="docutils literal">get</tt> to call the <tt class="docutils literal">get_context_data</tt> (of <tt class="docutils literal">SingleObjectMixin</tt>) and finally
the <tt class="docutils literal">SingleObjectTemplateResponseMixin</tt> will automatically generate the template name (i.e generate
<tt class="docutils literal">app_label/app_model_detail.html</tt>).</p>
</div>
<div class="section" id="the-createview">
<h3>The&nbsp;CreateView</h3>
<p>The next Django <span class="caps">CBV</span> we&#8217;ll talk about is <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#createview">CreateView</a>. This class is used to create a new instance
of a model. It has a rather complex hierarchy diagram but we&#8217;ve already discussed most of these&nbsp;classes:</p>
<img src="https://yuml.me/diagram/plain;/class/[SingleObjectTemplateResponseMixin%7Bbg:white%7D]%5E-[CreateView%7Bbg:green%7D],%20[TemplateResponseMixin%7Bbg:white%7D]%5E-[SingleObjectTemplateResponseMixin%7Bbg:white%7D],%20[BaseCreateView%7Bbg:white%7D]%5E-[CreateView%7Bbg:green%7D],%20[ModelFormMixin%7Bbg:white%7D]%5E-[BaseCreateView%7Bbg:white%7D],%20[FormMixin%7Bbg:white%7D]%5E-[ModelFormMixin%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[FormMixin%7Bbg:white%7D],%20[SingleObjectMixin%7Bbg:white%7D]%5E-[ModelFormMixin%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[SingleObjectMixin%7Bbg:white%7D],%20[ProcessFormView%7Bbg:white%7D]%5E-[BaseCreateView%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[ProcessFormView%7Bbg:white%7D].svg" /><p>As we can see the <tt class="docutils literal">CreateView</tt> inherits from <tt class="docutils literal">BaseCreateView</tt> and <tt class="docutils literal">SingleObjectTemplateResponseMixin</tt>. The
<tt class="docutils literal">SingleObjectTemplateResponseMixin</tt> is mainly used to define the template names that will be searched for
(i.e <tt class="docutils literal">app_label/app_model_form.html</tt>), while the <tt class="docutils literal">BaseCreateView</tt>
is used to combine the functionality of <tt class="docutils literal">ProcessFormView</tt> (that handles the basic form workflow as we have
already discussed) and <tt class="docutils literal">ModelFormMixin</tt>. The <tt class="docutils literal">ModelFormMixin</tt> is a rather complex mixin that inherits from
both <tt class="docutils literal">SingleObjectMixin</tt> and <tt class="docutils literal">FormMixin</tt>. The <tt class="docutils literal">SingleObjectMixin</tt> functionality is not really used by <tt class="docutils literal">CreateView</tt>
(since no object will need to be retrieved for the <tt class="docutils literal">CreateView</tt>) however the <tt class="docutils literal">ModelFormMixin</tt> is also used
by <tt class="docutils literal">UpdateView</tt> that&#8217;s why <tt class="docutils literal">ModelFormMixin</tt> also inherits from it (to retrieve the object that will be&nbsp;updated).</p>
<p><tt class="docutils literal">ModelFormMixin</tt> mixin adds functionality
for handling forms related to models and object instances. More specifically it adds functionality for:
* creating a form class (if one is not provided) by the configured model / queryset. If you don&#8217;t provide the form class (by using the <tt class="docutils literal">form_class</tt> attribute) then you need to configure the fields that the generated form will display by passing an array of field names through the <tt class="docutils literal">fields</tt> attribute
* overrides the <tt class="docutils literal">form_valid</tt> in order to save the object instance of the form
* fixes <tt class="docutils literal">get_success_url</tt> to redirect to the saved object&#8217;s absolute_url when the object is saved
* pass the current object to be updated (that was retrieving through the <tt class="docutils literal">SingleObjectMixin</tt>) -if there is a current object- to the form as the <tt class="docutils literal">instance</tt> attribute</p>
</div>
<div class="section" id="the-updateview-and-deleteview">
<h3>The UpdateView and&nbsp;DeleteView</h3>
<p>The <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#updateview">UpdateView</a> class is almost identical to the <tt class="docutils literal">CreateView</tt> - the only difference is that
<tt class="docutils literal">UpdateView</tt> inherits from <tt class="docutils literal">BaseUpdateView</tt> (and <tt class="docutils literal">SingleObjectTemplateResponseMixin</tt>) instead
of <tt class="docutils literal">BaseCreateView</tt>.  The <tt class="docutils literal">BaseUpdateView</tt> overrides the <tt class="docutils literal">get</tt> and <tt class="docutils literal">post</tt> methods of
<tt class="docutils literal">ProcessFormView</tt> to retrieve the object (using <tt class="docutils literal">SingleObjectMixin</tt>&#8216;s <tt class="docutils literal">get_object()</tt>)
and assign it to an instance variable - this will then be picked up by the <tt class="docutils literal">ModelFormMixin</tt> and used
properly in the form as explained before. One thing I notice here is that it seems that the hierarchy would
be better if the <tt class="docutils literal">ModelFormMixin</tt> inherited <em>only</em> from <tt class="docutils literal">FormMixin</tt> (instead of both from
<tt class="docutils literal">FormMixin</tt> and <tt class="docutils literal">SingleObjectMixin</tt>) and <tt class="docutils literal">BaseUpdateView</tt> inheriting from <tt class="docutils literal">ProcessFormView</tt>,
<tt class="docutils literal">ModelForMixin</tt> <em>and</em> <tt class="docutils literal">SingleObjectMixin</tt>. This way the <tt class="docutils literal">BaseCreateView</tt> wouldn&#8217;t get the
non-needed <tt class="docutils literal">SingleObjectMixin</tt> functionality. I am not sure why Django is implemented this way
(i.e the <tt class="docutils literal">ModelFormMixin</tt> also inheriting from <tt class="docutils literal">SingleObjectMixin</tt> thus passing this non-needed
functionality to <tt class="docutils literal">BaseCreateView</tt>) &#8212; if a reader has a clue I&#8217;d like to know&nbsp;it.</p>
<p>In any way, I&#8217;d like to also present the <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#deleteview">DeleteView</a> which is more or less the same as the <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#detailview">DetailView</a>
with the addition of the <tt class="docutils literal">DeleteMixin</tt> in the mix. The <tt class="docutils literal">DeleteMixin</tt> adds a <tt class="docutils literal">post()</tt> method
that will delete the object when called and makes <tt class="docutils literal">success_url</tt> required (since there would be no
object to redirect to after this view is&nbsp;posted).</p>
</div>
<div class="section" id="access-control-mixins">
<h3>Access control&nbsp;mixins</h3>
<p>Another small hierarchy of class based views (actually these are all mixins) are the authentication ones which
can be used to control access to a view.
These are <tt class="docutils literal">AcessMixin</tt>, <tt class="docutils literal">LoginRequiredMixin</tt>, <tt class="docutils literal">PermissionRequiredMixin</tt> and <tt class="docutils literal">UserPassesTestMixin</tt>.
The <tt class="docutils literal">AccessMixin</tt> provides some basic functionality (i.e what to do when the user does not have access
to the view, find out the login url to redirect him etc) and is used as a base for the other three. These
three override the <tt class="docutils literal">dispatch()</tt> method of <tt class="docutils literal">View</tt> to check if the user has the specific rights (i.e
if he has logged in for <tt class="docutils literal">LoginRequiredMixin</tt>, if he has the defined permissions for <tt class="docutils literal">PermissionRequiredMixin</tt>
or if he passes the provided test in <tt class="docutils literal">UserPassesTextMixin</tt>). If the user has the rights the view will proceed
as normally (call super&#8217;s dispatch) else the access denied functionality from <tt class="docutils literal">AccessMixin</tt> will be&nbsp;implemented.</p>
</div>
<div class="section" id="some-other-cbvs">
<h3>Some other&nbsp;CBVs</h3>
<p>Beyond the class based views I discussed in this section, Django also has a bunch of CBVs related
to account views (<tt class="docutils literal">LoginView</tt>, <tt class="docutils literal">LogoutView</tt>, <tt class="docutils literal">PasswordChangeView</tt> etc) and Dates (<tt class="docutils literal">DateDetailView</tt>, <tt class="docutils literal">YearArchiveView</tt> etc).
I won&#8217;t go into detail about these since they follow the same concepts and use most of the mixins
we&#8217;ve discussed before. Using the <span class="caps">CBV</span> Inspector you should be able to follow along and decide the methods you need
to override for your&nbsp;needs.</p>
<p>Also, most well written Django packages will define their own CBVs that inherit
from the Django CBVs - with the knowledge you acquired here you will be able to follow along on their source code to understand how everything&nbsp;works.</p>
</div>
</div>
<div class="section" id="real-world-use-cases">
<h2>Real world use&nbsp;cases</h2>
<p>In this section I am going to present a number of use cases demonstrating the usefulness of Django CBVs. In most of
these examples I am going to override one of the methods of the mixins I discussed in the previous section. There
are <em>two</em> methods you can use for integrating the following use cases to your&nbsp;application.</p>
<p>Create your own class inheriting from one of the Django CBVs and add to it directly the method to override. For example,
if you wanted to override the <tt class="docutils literal">get_queryset()</tt> method a <tt class="docutils literal">ListView</tt> you would do&nbsp;a:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">GetQuerysetOverrideListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;PUBLISHED&#39;</span><span class="p">)</span>
</pre></div>
<p>This is useful if you know that you aren&#8217;t going to need the overriden <tt class="docutils literal">get_queryset</tt> functionality to a different
method and following the <span class="caps">YAGNI</span> principle (or if you know that even if you need it you could inherit from <tt class="docutils literal">GetQuerysetOverrideListView</tt>
i.e in another ListView).
However, if you know that there may be more CBVs that would need their
queryset filtered by <tt class="docutils literal"><span class="pre">status='<span class="caps">PUBLISHED</span>'</span></tt> then you should add a mixin that would be used by your&nbsp;CBVs:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">GetQuerysetOverrideMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;PUBLISHED&#39;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GetQuerysetOverrideListView</span><span class="p">(</span><span class="n">GetQuerysetOverrideMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
<p>Now, one thing that needs some discussion here is that the method <tt class="docutils literal">get_queryset</tt> is provided by a mixin (in fact
it is provided by two mixins: <tt class="docutils literal">MultipleObjectMixin</tt> for <tt class="docutils literal">ListView</tt> and <tt class="docutils literal">SingleObjectMixin</tt> for <tt class="docutils literal">DetailView</tt>,
<tt class="docutils literal">UpdateView</tt> and <tt class="docutils literal">DeleteView</tt>). Because of how <span class="caps">MRO</span> works, I won&#8217;t need to inherit <tt class="docutils literal">GetQuerysetOverrideMixin</tt> from
<tt class="docutils literal">MultipleObjectMixin</tt> (or <tt class="docutils literal">SingleObjectMixin</tt> but let&#8217;s ignore that for now) but I can just inherit from object
and make sure that, as already discussed, put the mixin <em>before</em> (to the left) of the <span class="caps">CBV</span>. Notice that even if I had
defined <tt class="docutils literal">GetQuerysetOverrideMixin</tt> as <tt class="docutils literal">GetQuerysetOverrideMixin(MultipleObjectMixin)</tt> the <tt class="docutils literal">MultipleObjectMixin</tt> class would
be found <em>twice</em> in the <span class="caps">MRO</span> list so only the rightmost instance would remain. So the <span class="caps">MRO</span> for both <tt class="docutils literal">GetQuerysetOverrideMixin(object, )</tt>
and <tt class="docutils literal">GetQuerysetOverrideMixin(MultipleObjectMixin)</tt> <em>would be the same</em>! Also, inheriting directly from object makes
our <tt class="docutils literal">GetQuerysetOverrideMixin</tt> more <span class="caps">DRY</span> since if it inherited from <tt class="docutils literal">MultipleObjectMixin</tt> we&#8217;d need to create <em>another</em>
version of it that would inherit from <tt class="docutils literal">SingleObjectMixin</tt>; this is because <tt class="docutils literal">get_queryset</tt> exists in both these&nbsp;mixins.</p>
<p>For some of the following use cases I am also going to use the following models for user generated content (articles and uploaded&nbsp;files):</p>
<div class="highlight"><pre><span></span><span class="n">STATUS_CHOICES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;DRAFT&#39;</span><span class="p">,</span> <span class="s1">&#39;Draft&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;PUBLISHED&#39;</span><span class="p">,</span> <span class="s1">&#39;Published&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;REMOVED&#39;</span><span class="p">,</span> <span class="s1">&#39;Removed&#39;</span><span class="p">,</span> <span class="p">),</span>
<span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">permissions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;publisher_access&quot;</span><span class="p">,</span> <span class="s2">&quot;Publisher Access&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;admin_access&quot;</span><span class="p">,</span> <span class="s2">&quot;Admin Access&quot;</span><span class="p">),</span>
        <span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AbstractGeneralInfo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">STATUS_CHOICES</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">created_on</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">created_by</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(class)s</span><span class="s1">_created_by&#39;</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">modified_on</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">modified_by</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(class)s</span><span class="s1">_modified_by&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="n">owned_by</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(class)s</span><span class="s1">_owned_by&#39;</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">published_on</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Article</span><span class="p">(</span><span class="n">AbstractGeneralInfo</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Document</span><span class="p">(</span><span class="n">AbstractGeneralInfo</span><span class="p">):</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">()</span>
</pre></div>
<p>All this can be found on the accompanying project <a class="reference external" href="https://github.com/spapas/cbv-tutorial">https://github.com/spapas/cbv-tutorial</a> on the djangocbv app (visit <a class="reference external" href="http://127.0.0.1:8001/djangocbv/">http://127.0.0.1:8001/djangocbv/</a>).</p>
<div class="section" id="do-something-when-a-valid-form-is-submitted">
<h3>Do something when a valid form is&nbsp;submitted</h3>
<p>When a form is submitted and the form is valid
the <tt class="docutils literal">form_valid</tt> method of <tt class="docutils literal">ModelForMixin</tt> (and <tt class="docutils literal">FormMixin</tt>) will be called. This method
can be overridden to do various things before (or after) the form is saved. For example,
you may want have a field whose value is calculated from other fields in the form or you want to
create an extra object. Let&#8217;s see a generic example of overriding a <tt class="docutils literal">CreateView</tt> or <tt class="docutils literal">UpdateView</tt> with&nbsp;comments:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="p">):</span>
    <span class="c1"># let&#39;s calculate a field value</span>
    <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">calculated_field</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">form</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">]</span>

    <span class="c1"># save the form by calling super().form_valid(); keep the return value - it is the value of get_success_url</span>
    <span class="n">redirect_to</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>

    <span class="c1"># For Create or UpdateView, the just-saved object will be assigned to self.object</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Created an object with id </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="c1"># return the redirect</span>
    <span class="k">return</span> <span class="n">redirect_to</span>
</pre></div>
<p>This is rather complex so I&#8217;ll also explain it: The form_valid gets the actual form which, since is validated
has a <tt class="docutils literal">cleaned_data</tt> dictionary of values. This form also has an <tt class="docutils literal">instance</tt> attribute which is the object
that this form is bound to - notice that a normal <tt class="docutils literal">Form</tt> won&#8217;t have an instance only a <tt class="docutils literal">ModelForm</tt>.
This can be used to modify the instance of this form as needed - before saving it. When you want to actually save
the instance you call <tt class="docutils literal"><span class="pre">super().form_valid()</span></tt> passing it the modified form (and instance). This method does
three&nbsp;things</p>
<ul class="simple">
<li>It saves the instance to the&nbsp;database</li>
<li>It assigns the saved object to the <tt class="docutils literal">object</tt> instance attribute (so you can refer to it by <tt class="docutils literal">self.instance</tt>)</li>
<li>It uses <tt class="docutils literal">get_redirect_url</tt> to retrieve the location where you should redirect after the form is&nbsp;submitted</li>
</ul>
<p>Thus in this example we save <tt class="docutils literal">redirect_to</tt> to return it also from our method also and then can use <tt class="docutils literal">self.object.id</tt>
to log the id of the current&nbsp;object.</p>
<p>On a more specific example, notice the <tt class="docutils literal">Article</tt> and <tt class="docutils literal">Document</tt> models which both inherit (abstract)
from <tt class="docutils literal">AbstractGeneralInfo</tt> have a <tt class="docutils literal">created_by</tt> and
a <tt class="docutils literal">modified_by</tt> field. These fields have to be filled automatically from the current logged in user. Now, there are various
options to do that but what I vote for is using an <tt class="docutils literal">AuditableMixin</tt> as I have already described in <a class="reference external" href="https://spapas.github.io/2015/01/21/django-model-auditing/#adding-simple-auditing-functionality-ourselves">my Django model auditing article</a>.</p>
<p>To replicate the functionality we&#8217;ll create an <tt class="docutils literal">AuditableMixin</tt> like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AuditableMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">,):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">created_by</span><span class="p">:</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">created_by</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">modified_by</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
</pre></div>
<p>This mixin can be used by both the create and update view of both <tt class="docutils literal">Article</tt> and <tt class="docutils literal">Document</tt>. So all four of these
classes will share the same functionality. Notice that the <tt class="docutils literal">form_valid</tt> method is overridden - the <tt class="docutils literal">created_by</tt>
of the form&#8217;s instance (which is the object that was edited, remember how <tt class="docutils literal">ModelFormMixin</tt> works) will by set
to the current user if it is null (so it will be only set once) while the <tt class="docutils literal">modified_by</tt> will be set always to the
current user. Finally we call <tt class="docutils literal"><span class="pre">super().form_valid</span></tt> and return its response so
that the form will be actually saved and the redirect will go to the proper success url. To use it for example for the
<tt class="docutils literal">Article</tt>, <tt class="docutils literal">CreateView</tt> should be defined like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ArticleCreateView</span><span class="p">(</span><span class="n">AuditableMixin</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
</pre></div>
</div>
<div class="section" id="change-the-queryset-of-the-cbv">
<h3>Change the queryset of the <span class="caps">CBV</span></h3>
<p>All CBVs that inherit from <tt class="docutils literal">SingleObjectMixin</tt> or <tt class="docutils literal">MultipleObjectMixin</tt> (<tt class="docutils literal">ListView</tt>, <tt class="docutils literal">DetailView</tt>, <tt class="docutils literal">UpdateView</tt> and <tt class="docutils literal">DeleteView</tt>)
have a <tt class="docutils literal">model</tt> and a <tt class="docutils literal">queryset</tt> property that can be used (either one or the other) to define the queryset that will be used for
querying the database for that CBVs results. This queryset can be further dynamically refined by overriding the <tt class="docutils literal">get_queryset()</tt> method.
What I usually do is that I define the <tt class="docutils literal">model</tt> attribute and then override <tt class="docutils literal">get_querset</tt> in order to dynamically modify the&nbsp;queryset.</p>
<p>For example, let&#8217;s say that I wanted to add a count of articles and documents per each category. Here&#8217;s how the <tt class="docutils literal">CategoryListView</tt> could be&nbsp;done:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CategoryListView</span><span class="p">(</span><span class="n">ExportCsvMixin</span><span class="p">,</span> <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;categories&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">article_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;article&#39;</span><span class="p">),</span> <span class="n">document_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">))</span>
</pre></div>
<p>Notice that I also use some more mixins for this <tt class="docutils literal">ListView</tt> (they&#8217;ll be explained later). The <tt class="docutils literal">get_queryset</tt> adds
the annotation to the <tt class="docutils literal">super()</tt> queryset (which will be <tt class="docutils literal">Category.objects.all()</tt>). One final comment is that instead
of this, I could have more or less the same functionality by implementing <tt class="docutils literal">CategoryListView</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CategoryListView</span><span class="p">(</span><span class="n">ExportCsvMixin</span><span class="p">,</span> <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;categories&#39;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">article_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;article&#39;</span><span class="p">),</span> <span class="n">document_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">))</span>
</pre></div>
<p>This has the same functionality (return all categories with the number of articles and documents for each one) and
saves some typing from overriding the <tt class="docutils literal">get_queryset</tt>  method. However as I said most of the time I use the model
attribute and override the <tt class="docutils literal">get_queryset</tt> method because it seems more explicit and descriptive to me and most of
the time I&#8217;ll need to add some more filtering (based on the current user, based on some query parameter etc) that
can only be implemented on the <tt class="docutils literal">get_queryset</tt>.</p>
</div>
<div class="section" id="allow-each-user-to-list-view-edit-delete-only-his-own-items">
<h3>Allow each user to list/view/edit/delete only his own&nbsp;items</h3>
<p>Continuing from the previous example of modifying the queryset, let&#8217;s suppose that we want to allow each
user to be able to list the items (articles and
documents) he has created and view/edit/delete them. We also want to allow admins and publishers to view/edit&nbsp;everything.</p>
<p>Since the <tt class="docutils literal">Article</tt> and <tt class="docutils literal">Document</tt> models both have an <tt class="docutils literal">owned_by</tt> element we can use use this to filter
the results returned by <tt class="docutils literal">get_queryset()</tt>. For example, here&#8217;s a mixin that checks if the current user is
admin or publisher. If he is a publisher then he will just return the <tt class="docutils literal">super()</tt> queryset. If however he is a simple
user it will return only the results that are owned by him with <tt class="docutils literal">qs.filter(owned_by=self.request.user)</tt>.</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LimitAccessMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;djangocbv.admin_access&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;djangocbv.publisher_access&#39;</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">qs</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">owned_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
<p>Another similar mixin that is used is the <tt class="docutils literal">HideRemovedMixin</tt> that, for simple users, excludes from the queryset the objects that
are&nbsp;removed:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">HideRemovedMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;djangocbv.admin_access&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;djangocbv.publisher_access&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">qs</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;REMOVED&#39;</span><span class="p">)</span>
</pre></div>
<p>One thing that needs a little discussion is that for both of these mixins I am using <tt class="docutils literal">get_queryset</tt> to implement access control to
allow using the same mixin for views that inherit from both <tt class="docutils literal">SingleObjectMixin</tt> and <tt class="docutils literal">MultipleObjectMixin</tt> (since the <tt class="docutils literal">get_queryset</tt> is
used in both of them). This
means that when a user tries to access an object that has not access to he&#8217;ll get a nice 404&nbsp;error.</p>
<p>Beyond this, instead of filtering the queryset,
for views inheriting from <tt class="docutils literal">SingleObjectMixin</tt> (i.e <tt class="docutils literal">DetailView</tt>, <tt class="docutils literal">UpdateView</tt> and <tt class="docutils literal">DeleteView</tt>)
we could have overridden the <tt class="docutils literal">get_object</tt> method to raise an access denied exception. Here&#8217;s how <tt class="docutils literal">get_object</tt> could be
overridden to raise a 403 Forbidden status when a user tries to access an object that does not belong to&nbsp;him:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">PermissionDenied</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_object</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">owned_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PermissionDenied</span>
    <span class="k">return</span> <span class="n">obj</span>
</pre></div>
</div>
<div class="section" id="configure-the-form-s-initial-values-from-get-parameters">
<h3>Configure the form&#8217;s initial values from <span class="caps">GET</span>&nbsp;parameters</h3>
<p>Sometimes we want to have a <tt class="docutils literal">CreateView</tt> with some fields already filled. I usually
implement this by passing the proper parameters to the <span class="caps">URL</span> (i.e by calling it as /create_view?category_id=2)
and then using the following mixin to override the <tt class="docutils literal">FormMixin</tt> <tt class="docutils literal">get_initial</tt> method in order to
return the form&#8217;s initial data from&nbsp;it:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SetInitialMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">,):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_initial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">initial</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SetInitialMixin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_initial</span><span class="p">()</span>
        <span class="n">initial</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">initial</span>
</pre></div>
<p>So if the /article_create url can be used to initialte the <tt class="docutils literal">CreateView</tt> for the article,
using <tt class="docutils literal"><span class="pre">/article_create?category_id=3</span></tt> will show the CreateView with the Category with id=3
pre-selected in the category&nbsp;field!</p>
</div>
<div class="section" id="pass-extra-kwargs-to-the-formview-form">
<h3>Pass extra kwargs to the FormView&nbsp;form</h3>
<p>This is a very common requirement. The form may need to be modified by an external condition,
for example the current user or something that can be calculated from the view. Here&#8217;s a
sample mixin that passes the current request (which also includes the user) to the&nbsp;form:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RequestArgMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_form_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RequestArgMixin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_form_kwargs</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>
<p>Please notice that the form has to properly handle the extra kwarg in its constructor,
before calling the super&#8217;s constructor. For
example, here&#8217;s how a form that can accept the request could be&nbsp;implemented:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RequestForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
<p>We use <tt class="docutils literal">pop</tt> to remove the request from the received <tt class="docutils literal">kwargs</tt> and only then we call the
parent&nbsp;constructor.</p>
</div>
<div class="section" id="add-values-to-the-context">
<h3>Add values to the&nbsp;context</h3>
<p>To add values to the context of a <span class="caps">CBV</span> we override the <tt class="docutils literal">get_context_data()</tt> method. Here&#8217;s
a mixin that adds a list of categories to all CBVs using&nbsp;it:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CategoriesContextMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ctx</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ctx</span>
</pre></div>
<p>Notice that the mixin calls super to get the context data of its ancestors and appends to it. This
mean that if we also had a mixin that f.e added the current logged in user to the context (this isn&#8217;t really
needed since there&#8217;s a context processor for this but anyway) then when a <span class="caps">CBV</span> inherited from both of
them then the data of both of them would be added to the&nbsp;context.</p>
<p>As a general comment there are three other methods the same functionality could be&nbsp;achieved:</p>
<ul class="simple">
<li>Just override the <tt class="docutils literal">get_context_data</tt> of the <span class="caps">CBV</span> you want to add extra data to its&nbsp;context</li>
<li>Add a template tag that will bring the needed data to the&nbsp;template</li>
<li>Use a context processor to bring the data to all&nbsp;templates</li>
</ul>
<p>As can be understood, each of the above methods has certain advantages and disadvantages. For
example, if the extra data will query the database then the context processor method will add
one extra query for all page loads (even if the data is not needed). On the other hand,
the template tag will query the database only on specific views but it makes debugging and
reasoning about your template more difficult since if you have a lot of template tags you&#8217;ll have
various context variables appearing from thing&nbsp;air!</p>
<p>One final comment is that overriding the <tt class="docutils literal">get_context_data</tt> method will probably be the most
common thing you&#8217;re going to do when using CBVs (you&#8217;ll definitely need to add things to the context)
so try to remember the following 3 needed&nbsp;lines:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># ... here we add stuff to the ctx</span>
    <span class="k">return</span> <span class="n">ctx</span>
</pre></div>
</div>
<div class="section" id="add-a-simple-filter-to-a-listview">
<h3>Add a simple filter to a&nbsp;ListView</h3>
<p>For filtering I recommend using the excellent <a class="reference external" href="https://github.com/carltongibson/django-filter">django-filter</a> package as I&#8217;ve already
presented in <a class="reference external" href="https://spapas.github.io/2017/10/11/essential-django-packages/">my essential Django package list</a>. Here&#8217;s how a mixin can be created that
adds a filter to the&nbsp;context:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AddFilterMixin</span><span class="p">:</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_class</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please define filter_class when using AddFilterMixin&quot;</span><span class="p">)</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">())</span>
        <span class="n">ctx</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">filter</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_object_name</span><span class="p">:</span>
            <span class="n">ctx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">context_object_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">qs</span>
        <span class="k">return</span> <span class="n">ctx</span>
</pre></div>
<p>Notice that the <tt class="docutils literal">get_context_data</tt> checks to see if the <tt class="docutils literal">filter_class</tt> attribute has been
defined (if not it will raise a useful explanation). It will then instantiate the filter class
passing it the <tt class="docutils literal">self.request.<span class="caps">GET</span></tt> and the current queryset (<tt class="docutils literal">self.get_queryset()</tt>) - so for
example any extra filtering you are doing to the queryset (for example only show content owned by the
current user) will be also used. Finally, pass the filter to the context and assign the
contect_object_name to the filtered&nbsp;queryset.</p>
<p>Here&#8217;s for example how this mixin is used for <tt class="docutils literal">ArticleListView</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ArticleListView</span><span class="p">(</span><span class="n">AddFilterMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;articles&#39;</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">ArticleFilter</span>
</pre></div>
<p>And then just add the following to the <tt class="docutils literal">article_list.html</tt> template:</p>
<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="o">&gt;</span>
    <span class="p">{{</span> <span class="nb">filter</span><span class="o">.</span><span class="n">form</span> <span class="p">}}</span>
    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;submit&#39;</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Filter&#39;</span> <span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">articles</span> <span class="o">%</span><span class="p">}</span>
    <span class="n">Display</span> <span class="n">article</span> <span class="n">info</span> <span class="o">-</span> <span class="n">only</span> <span class="n">filtered</span> <span class="n">articles</span> <span class="n">will</span> <span class="n">be</span> <span class="n">here</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="section" id="support-for-success-messages">
<h3>Support for success&nbsp;messages</h3>
<p>Django has a very useful <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/contrib/messages/">messages framework</a> which can be used to add flash messages
to a view. A flash message is a message that persists in the sesion until it is viewed
by the user. So, for example when a user edits an object and saves it, he&#8217;ll be redirected
to the success page - if you have configured a flash message to inform the user that the
save was ok then he&#8217;ll see this message once and then if he reloads the page it will
be&nbsp;removed.</p>
<p>Here&#8217;s a mixin that can be used to support flash messages using Django&#8217;s message&nbsp;framework:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SuccessMessageMixin</span><span class="p">:</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_success_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_message</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_success_message</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
</pre></div>
<p>This mixin overrides the <tt class="docutils literal">form_valid</tt> and adds the message using <tt class="docutils literal">get_success_message</tt> - this
can be overriden if you want to have a dynamic message or just set the <tt class="docutils literal">success_message</tt> attribute
for a static message, for example something like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SuccesMessageArticleCreateView</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">):</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object was created!&#39;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
</pre></div>
<p>I&#8217;d like to once again point out here that since the <tt class="docutils literal"><span class="pre">super().form_valid(form)</span></tt> method is properly used
then if a <span class="caps">CBV</span> uses multiple mixins that override form_valid (for example if your <span class="caps">CBV</span> overrides both
<tt class="docutils literal">SuccessMessageMixin</tt> and <tt class="docutils literal">AuditableMixin</tt> then the form_valid of <em>both</em> will be called so you&#8217;ll
get both the created_by/modified_by values set to the current user and the success&nbsp;message!</p>
<p>Notice that Django actually provides an implementation of <a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/contrib/messages/#adding-messages-in-class-based-views">a message mixin</a> which can be used instead
of the proposed implementation here (I didn&#8217;t know it until recently that&#8217;s why I am using this to some
projects and I also present it&nbsp;here).</p>
</div>
<div class="section" id="implement-a-quick-moderation">
<h3>Implement a quick&nbsp;moderation</h3>
<p>It is easy to implement some moderation to our model publishing. For example, let&#8217;s suppose that we only
allow publishers to publish a model. Here&#8217;s how it can be&nbsp;done:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="s1">&#39;REMOVED&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="s1">&#39;djangocbv.publisher_access&#39;</span><span class="p">):</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;PUBLISHED&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;DRAFT&#39;</span>

    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
</pre></div>
<p>So, first of all we make sure that the object is not <tt class="docutils literal"><span class="caps">REMOVED</span></tt> (if it is
remove it we don&#8217;t do anything else). Next we check if the current user has
<tt class="docutils literal">publisher_access</tt> if yes we change the object&#8217;s status to <tt class="docutils literal"><span class="caps">PUBLISHED</span></tt> - on any
other case we change its status to <tt class="docutils literal"><span class="caps">DRAFT</span></tt>. Notice that this means that whenever a
publisher saves the object it will be published and whenever a non-publisher saves it
it will be made a draft. We then call our ancestor&#8217;s <tt class="docutils literal">form_valid</tt> to save the object
and return to success&nbsp;url.</p>
<p>I&#8217;d like to repeat here that this mixin, since it calls super, can work concurrently
with any other mixins that override <tt class="docutils literal">form_valid</tt> (and also call their super method
of course), for example it can be used together with the audit (auto-fill created_by
and moderated_by) and the success mixin we defined&nbsp;previously!</p>
</div>
<div class="section" id="allow-access-to-a-view-if-a-user-has-one-out-of-a-group-of-permissions">
<h3>Allow access to a view if a user has one out of a group of&nbsp;permissions</h3>
<p>For this we&#8217;ll need to use the authentication mixins functionality. We could implement
this by overriding <tt class="docutils literal">PermissionRequiredMixin</tt> or by overriding <tt class="docutils literal">UserPassesTestMixin</tt>.</p>
<p>Using <tt class="docutils literal">PermissionRequiredMixin</tt> is not very easy because the way it works
it will allow access if the user has <em>all</em> permissions from the group (not only one as is the requirement).
Of course you could override its <tt class="docutils literal">has_permission</tt> method to change the way it checks if
the user has the permissions (i.e make sure it has one permission instead of&nbsp;all):</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AnyPermissionRequiredMixin</span><span class="p">(</span><span class="n">PermissionRequiredMixin</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">perms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permission_required</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span> <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">)</span>
</pre></div>
<p>Also we could implement our mixin using <tt class="docutils literal">UserPassesTestMixin</tt> as its&nbsp;base:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AnyPermissionRequiredAlternativeMixin</span><span class="p">(</span><span class="n">UserPassesTestMixin</span><span class="p">):</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">has_perm</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span> <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">)</span>
</pre></div>
<p>The functionality is very simple: If the user has one of the list of the configured permissions then the test will pass (so he&#8217;ll have access to the view).
If instead the user has none of the permissions then he won&#8217;t be able to access the&nbsp;view.</p>
<p>Notice that for the above implementations we inherited from <tt class="docutils literal">PermissionRequiredMixin</tt> or <tt class="docutils literal">UserPassesTextMixin</tt> to keep their functionality - if we had inherited
these mixins from object then we&#8217;d need to inherit our CBVs from both <tt class="docutils literal">AnyPermissionRequiredMixin</tt> and <tt class="docutils literal">PermissionRequiredMixin</tt> or
<tt class="docutils literal">AnyPermissionRequiredAlternativeMixin</tt> and <tt class="docutils literal">UserPassesTestMixin</tt> (with the correct <span class="caps">MRO</span> order of&nbsp;course).</p>
<p>Now, the whole permission cheking functionality can be even more <span class="caps">DRY</span>. Let&#8217;s suppose that we know that there are a couple of views which should only
be visible to users having either the <tt class="docutils literal">app.admin</tt> or <tt class="docutils literal">app.curator</tt> permission. Instead of inheriting all these views from <tt class="docutils literal">AnyPermissionRequiredMixin</tt>
and configuring the permissions list to each one, the <span class="caps">DRY</span> way to implement this is to add yet another mixin from which the CBVs will actually&nbsp;inhert:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AdminOrPublisherPermissionRequiredMixin</span><span class="p">(</span><span class="n">AnyPermissionRequiredMixin</span><span class="p">):</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;djangocbv.admin_access&#39;</span><span class="p">,</span> <span class="s1">&#39;djangocbv.publisher_access&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="disable-a-view-based-on-some-condition">
<h3>Disable a view based on some&nbsp;condition</h3>
<p>There are times you want to disable a view based on an arbitrary condition - for example example make the view
disabled before a specific date. Here&#8217;s a simple mixin that overrides <tt class="docutils literal">dispatch</tt> to do&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DisabledDateMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">the_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">the_date</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PermissionDenied</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
<p>You can even disable a view completely  in case you want to keep it in your urls.py using this&nbsp;mixin:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DisabledDateMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">PermissionDenied</span>
</pre></div>
</div>
<div class="section" id="output-non-html-views">
<h3>Output non-html&nbsp;views</h3>
<p>I&#8217;ve written a whole article about this, please take a look at my <a class="reference external" href="https://spapas.github.io/2014/09/15/django-non-html-responses/">Django non-<span class="caps">HTML</span> responses</a>&nbsp;article.</p>
<p>Also, notice that is very easy to create a mixin that will output a view to <span class="caps">PDF</span> - I have already written
an <a class="reference external" href="https://spapas.github.io/2015/11/27/pdf-in-django/#using-a-cbv">essential guide for outputting PDFs in Django</a> so I am just going to refer you to this article for
(much more)&nbsp;information!</p>
<p>Finally, let&#8217;s take a look at a generic Mixin that you can use to add <span class="caps">CSV</span> exporting capabilities to a
<tt class="docutils literal">ListView</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExportCsvMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/csv&#39;</span><span class="p">)</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=&quot;export.csv&quot;&#39;</span>

            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;object_list&#39;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Write headers</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">response</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">render_to_response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>
<p>As you can see this mixin overrides the <tt class="docutils literal">render_to_response</tt> method. It will check if there&#8217;s a
<tt class="docutils literal">csv</tt> key to the <tt class="docutils literal"><span class="caps">GET</span></tt> queryset dictionary, thus the url must be called with <tt class="docutils literal"><span class="pre">?csv=true</span></tt> or something similar. You
can just add this link to your&nbsp;template:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;button&#39;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#39;?csv=true&#39;</span><span class="p">&gt;</span>Export csv<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
<p>So if the view needs to be exported to <span class="caps">CSV</span>, it will create a new <tt class="docutils literal">HttpResponse</tt> object with the correct content type.
The next line will add a header that (<tt class="docutils literal"><span class="pre">Content-Disposition</span></tt>) will mark the response as an attachment and give it a default file name.
We then crate a new <tt class="docutils literal">csv.writer</tt> passing the just-created response as the place to write the csv. The <tt class="docutils literal">for</tt> loop that follows
enumerates the <tt class="docutils literal">object_list</tt> value of the context (remember that this is added by the <tt class="docutils literal">MultipleObjectMixin</tt> and contains the
result of the <tt class="docutils literal">ListView</tt>). It will then use the object&#8217;s <tt class="docutils literal">__dict__</tt> attribute to write the headers (for the first time) and then
write the values of all&nbsp;objects.</p>
<p>As another simple example, let&#8217;s create a quick <span class="caps">JSON</span> output mixin for our&nbsp;DetailViews:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">JsonDetailMixin</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">)))</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">render_to_response</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>
<p>If you add this to a view inheriting from <tt class="docutils literal">DetailView</tt> and pass it the <tt class="docutils literal"><span class="pre">?json=true</span></tt> query parameter
you&#8217;ll get a <span class="caps">JSON</span>&nbsp;response!</p>
</div>
<div class="section" id="use-one-templateview-for-multiple-html-templates">
<h3>Use one TemplateView for multiple html&nbsp;templates</h3>
<p>Using a <tt class="docutils literal">TemplateView</tt> you could display an html template without much problem just by
settings the <tt class="docutils literal">template</tt> attribute of your class. What if you wanted to have a single
<tt class="docutils literal">TemplateView</tt> that would display many templates based on the query path? Simple, just
override <tt class="docutils literal">get_template_names</tt> to return a different template based on the path. For example,
using this&nbsp;view:</p>
<div class="highlight"><pre><span></span>class DynamicTemplateView(TemplateView):
    def get_template_names(self):
        what = self.kwargs[&#39;what&#39;]
        return &#39;{0}.html&#39;.format(what)
</pre></div>
<p>You can render any template you have depending on the value of the <tt class="docutils literal">what</tt> kwarg. To allow
only specific template names you can either add a check to the above implementation (i.e that
what is <tt class="docutils literal">help</tt> or <tt class="docutils literal">about</tt>) or you may do it to the urls.py if you use a regular expression. Thus,
to only allow <tt class="docutils literal">help.html</tt> and <tt class="docutils literal">about.html</tt> to be rendered with this method add it to your urls like&nbsp;this:</p>
<div class="highlight"><pre><span></span>re_path(r&#39;^show/(?P<span class="p">&lt;</span><span class="nt">what</span><span class="p">&gt;</span>help|about)/&#39;, views.DynamicTemplateView.as_view(), name=&#39;template-show&#39;),
</pre></div>
<p>Finally, to use it to render the <tt class="docutils literal">help.html</tt> you&#8217;ll just call it like &lt;a href=&#8217;{% url &#8220;template-show&#8221; &#8220;help&#8221;&nbsp;%}&#8217;&gt;Help&lt;/a&gt;</p>
<p>Notice that of course instead of creating the <tt class="docutils literal">DynamicTemplateView</tt> you could just dump these html files in your
static folder and return them using the static files functionality. However the extra thing that the <tt class="docutils literal">DynamicTemplateView</tt>
brings to you is that this is a full Django template thus you can use template tags, filters, your context variables, inherit
from your site-base and even override <tt class="docutils literal">get_context_data</tt> to add extra info to the template! All this is not possible with
static&nbsp;files!</p>
</div>
<div class="section" id="implement-a-partial-ajax-view">
<h3>Implement a partial Ajax&nbsp;view</h3>
<p>Overriding <tt class="docutils literal">get_template_names</tt> can also be used to create a <span class="caps">DRY</span> Ajax view
of your data! For example, let&#8217;s say that you have a <tt class="docutils literal">DetailView</tt> for one of your models that
has overriden the <tt class="docutils literal">get_template_names</tt> like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_template_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ajax_partial&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;core/partial/data_ajax.html&#39;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_template_names</span><span class="p">()</span>
</pre></div>
<p>and you have also defined a normal template for classic request response viewing and an ajax template
that contains only the specific data for this instances (i.e it does not containg html body, headers, footers etc,
only a &lt;div&gt; with the instance&#8217;s data). Notice I&#8217;m using either the <tt class="docutils literal">is_ajax</tt> method or I directly passed <span class="caps">GET</span>
value (<tt class="docutils literal">ajax_partial</tt>) - this is needed because sometimes <tt class="docutils literal">is_ajax</tt> is not working as expected (depending on
how you&#8217;re going to do the request), also this way you can easily test the partial ajax view through your browser
by passing it <tt class="docutils literal"><span class="pre">?ajax_partia=true</span></tt>.</p>
<p>Using this technique you can create an Ajax view of your data just by requesting the DetailView through an
Ajax call and dumping the response you get to a modal dialog (for example)  - no need for fancy <span class="caps">REST</span> APIs. Also as
a bonus, the classic DetailView will work normally, so you can have the Ajax view to give a summary of the instance&#8217;s
data (i.e have a subset of the info on the Ajax template) and the normal view to display&nbsp;everything.</p>
</div>
<div class="section" id="add-a-dynamic-filter-and-or-table-to-the-context">
<h3>Add a dynamic filter and/or table to the&nbsp;context</h3>
<p>If you have a lot of similar models you can add a mixin that dynamically creates tables and a filters
for these models  - take a look at my <a class="reference external" href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/">dynamic tables and filters for similar models</a>&nbsp;article!</p>
</div>
<div class="section" id="configure-forms-for-your-views">
<h3>Configure forms for your&nbsp;views</h3>
<p>As I&#8217;ve already explained if you are using a <tt class="docutils literal">FormView</tt> you&#8217;ll need to set a <tt class="docutils literal">form_class</tt> for
your view (needed by <tt class="docutils literal">FormMixin</tt>) while, for an Update or <tt class="docutils literal">CreateView</tt> which use the <tt class="docutils literal">ModelFormMixin</tt>
you can either set the <tt class="docutils literal"><span class="pre">form-class</span></tt> or directly configure the instance&#8217;s fields that will be displayed
to the form using the <tt class="docutils literal">fields</tt> attribute.</p>
<p>For example, let&#8217;s say that you have a rather generic <tt class="docutils literal">FormView</tt> that will display a different form
depending on the user permissions. Here&#8217;s how you could do this to return a <tt class="docutils literal">SuperForm</tt> if the
current user is a superuser and a <tt class="docutils literal">SimpleForm</tt> in other&nbsp;cases:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_form_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_superuser</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SuperForm</span>
    <span class="k">return</span> <span class="n">SimpleForm</span>
</pre></div>
</div>
<div class="section" id="display-a-different-form-for-create-and-update">
<h3>Display a different form for Create and&nbsp;Update</h3>
<p>There are various ways you can do this (for example you can just declare a different <tt class="docutils literal">form_class</tt> for your
<tt class="docutils literal">Create</tt> and <tt class="docutils literal">UpdateView</tt>) but I think that the most <span class="caps">DRY</span> one, especially if the create and update form are
similar is to pass an <tt class="docutils literal">is_create</tt> argument to the form which it will then be used to properly configure the&nbsp;form.</p>
<p>Thus, on your <tt class="docutils literal">CreateView</tt> you&#8217;ll add this <tt class="docutils literal">get_form_kwargs</tt>:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_form_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyCreateView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_form_kwargs</span><span class="p">()</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;is_create&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>
<p>while on your <tt class="docutils literal">UpdateView</tt> you&#8217;ll add&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_form_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyUpdateView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_form_kwargs</span><span class="p">()</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;is_create&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>
<p>Please notice that the form has to properly handle the extra kwarg in its constructor as I&#8217;ve already explained&nbsp;previously.</p>
</div>
<div class="section" id="only-allow-specific-http-methods-for-a-view">
<h3>Only allow specific <span class="caps">HTTP</span> methods for a&nbsp;view</h3>
<p>Let&#8217;s say that you want to create an <tt class="docutils literal">UnpublishView</tt> i.e a view that will change the status of your content
to <tt class="docutils literal"><span class="caps">DRAFT</span></tt>. Since this view will change your model instance it must be called through <tt class="docutils literal"><span class="caps">POST</span></tt>, however
you may not want to display an individual form for this view, just a button that when called will display
a client-side (Javascript) prompt and if the user clicks it it will immediately do a <tt class="docutils literal"><span class="caps">POST</span></tt> request
by submitting the form. The best way to create this is to just implement an <tt class="docutils literal">UpdateView</tt> for your model
and change its form valid to change the status to <tt class="docutils literal"><span class="caps">DRAFT</span></tt>, something like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;DRAFT&#39;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
</pre></div>
<p>Beyond this, you&#8217;ll need to add a <tt class="docutils literal">fields = []</tt> attribute to your <tt class="docutils literal">UpdateView</tt> to denote that you won&#8217;t
need to update any fields from the model (since you&#8217;ll update the status directly) and finally, to only allow
this view to be called through an http <tt class="docutils literal"><span class="caps">POST</span></tt> method add the following&nbsp;attribute:</p>
<div class="highlight"><pre><span></span><span class="n">http_method_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<div class="section" id="create-an-umbrella-view-for-multiple-models">
<h3>Create an umbrella View for multiple&nbsp;models</h3>
<p>Let&#8217;s say that you have a couple of models (called <tt class="docutils literal">Type1</tt> and <tt class="docutils literal">Type2</tt> that are more or less the same and
you want to quickly create a <tt class="docutils literal">ListView</tt> for both of them but you&#8217;d like to create just one <tt class="docutils literal">ListView</tt> and
separate them by their url. Here&#8217;s how it could be&nbsp;done:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">UmbrellaListView</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span><span class="o">=</span><span class="s1">&#39;umbrella_list.html&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;type1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Type1</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;type2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Type2</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">UmbrellaListView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
<p>Notice that for this to work properly you must setup your urls like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^list/(?P&lt;kind&gt;type1|type2)/$&#39;</span><span class="p">,</span> <span class="n">UmbrellaListView</span><span class="o">.</span><span class="n">as_view</span><span class="p">()</span> <span class="p">)</span> <span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;umbrella_list&#39;</span> <span class="p">),</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="a-heavy-cbv-user-project">
<h2>A heavy <span class="caps">CBV</span> user&nbsp;project</h2>
<p>In this small chapter I&#8217;d like to present a bunch of mixins and views that I&#8217;ve defined to the
accompanying project (<a class="reference external" href="https://github.com/spapas/cbv-tutorial">https://github.com/spapas/cbv-tutorial</a>).</p>
<p>Let&#8217;s start with the mixins (I won&#8217;t show the mixins I&#8217;ve already talked about in the previous&nbsp;chapter):</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SetOwnerIfNeeded</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">owned_by_id</span><span class="p">:</span>
            <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">owned_by</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ChangeStatusMixin</span><span class="p">:</span>
    <span class="n">new_status</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_status</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Please define new_status when using ChangeStatusMixin&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">new_status</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ContentCreateMixin</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span>
                        <span class="n">AuditableMixin</span><span class="p">,</span>
                        <span class="n">SetOwnerIfNeeded</span><span class="p">,</span>
                        <span class="n">RequestArgMixin</span><span class="p">,</span>
                        <span class="n">SetInitialMixin</span><span class="p">,</span>
                        <span class="n">ModerationMixin</span><span class="p">,</span>
                        <span class="n">LoginRequiredMixin</span><span class="p">):</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object successfully created!&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ContentUpdateMixin</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span>
                        <span class="n">AuditableMixin</span><span class="p">,</span>
                        <span class="n">SetOwnerIfNeeded</span><span class="p">,</span>
                        <span class="n">RequestArgMixin</span><span class="p">,</span>
                        <span class="n">SetInitialMixin</span><span class="p">,</span>
                        <span class="n">ModerationMixin</span><span class="p">,</span>
                        <span class="n">LimitAccessMixin</span><span class="p">,</span>
                        <span class="n">LoginRequiredMixin</span><span class="p">):</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object successfully updated!&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ContentListMixin</span><span class="p">(</span><span class="n">ExportCsvMixin</span><span class="p">,</span> <span class="n">AddFilterMixin</span><span class="p">,</span> <span class="n">HideRemovedMixin</span><span class="p">,</span> <span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ContentRemoveMixin</span><span class="p">(</span><span class="n">SuccessMessageMixin</span>
                         <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span>
                         <span class="n">AuditableMixin</span><span class="p">,</span>
                         <span class="n">HideRemovedMixin</span><span class="p">,</span>
                         <span class="n">ChangeStatusMixin</span><span class="p">,):</span>
    <span class="n">http_method_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,]</span>
    <span class="n">new_status</span> <span class="o">=</span> <span class="s1">&#39;REMOVED&#39;</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object successfully removed!&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ContentUnpublishMixin</span><span class="p">(</span><span class="n">SuccessMessageMixin</span>
                            <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span>
                            <span class="n">AuditableMixin</span><span class="p">,</span>
                            <span class="n">UnpublishSuccessMessageMixin</span><span class="p">,</span>
                            <span class="n">ChangeStatusMixin</span><span class="p">,):</span>
    <span class="n">http_method_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,]</span>
    <span class="n">new_status</span> <span class="o">=</span> <span class="s1">&#39;DRAFT&#39;</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object successfully unpublished!&#39;</span>
</pre></div>
<p>The <tt class="docutils literal">SetOwnerIfNeeded</tt> and  <tt class="docutils literal">ChangeStatusMixin</tt> are simple mixins that override <tt class="docutils literal">form_valid</tt> to
introduce some functionality before saving the&nbsp;object).</p>
<p>The mixins that follow are used to group functionality of
other mixins together and will be inherited by the views. Thus, <tt class="docutils literal">ContentCreateMixin</tt> has the mixin functionality needed to create something (for example
an <tt class="docutils literal">Article</tt> or a <tt class="docutils literal">Document</tt>) i.e show a success message, add auditing information, set the object&#8217;s owner,
pass the request to the form, set the form&#8217;s initial values, do some moderation and only allow logged in users. On
a similar fashion, the <tt class="docutils literal">ContentUpdateMixin</tt> collects the functionality needed to update something and is similar to
<tt class="docutils literal">ContentCreateMixin</tt> (with the difference that it also as the <tt class="docutils literal">LimitAccessMixin</tt> to only allow simple users to
edit their own content). The <tt class="docutils literal">ContentListMixin</tt> adds functionality for export to <span class="caps">CSV</span>, simple filter and hiding removed&nbsp;things.</p>
<p>Finally, the <tt class="docutils literal">ContentRemoveMixin</tt> and <tt class="docutils literal">ContentUnpublishMixin</tt> are used to implement Views for removing and unpublishing
an object. Both of them inherit from <tt class="docutils literal">ChangeStatusMixin</tt> - one setting
the <tt class="docutils literal">new_status</tt> to <tt class="docutils literal"><span class="caps">REMOVED</span></tt> the other to <tt class="docutils literal"><span class="caps">DRAFT</span></tt>.</p>
<p>Notice that they share much functionality so I could
remove both <tt class="docutils literal">ContentRemoveMixin</tt> and <tt class="docutils literal">ContentUnpublishMixin</tt> and add a single <tt class="docutils literal">ContentChangeStatusMixin</tt> like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ContentChangeStatusMixin</span><span class="p">(</span><span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span>
                            <span class="n">AuditableMixin</span><span class="p">,</span>
                            <span class="n">UnpublishSuccessMessageMixin</span><span class="p">,</span>
                            <span class="n">ChangeStatusMixin</span><span class="p">,):</span>
    <span class="n">http_method_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">,]</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
<p>Thus the <tt class="docutils literal">new_status</tt> attribute wouldn&#8217;t be there so the views inheriting from this <tt class="docutils literal">ContentChangeStatusMixin</tt>
(i.e <tt class="docutils literal">*RemoveView</tt> and <tt class="docutils literal">*UnpublishView</tt>) would need to define the <tt class="docutils literal">new_status</tt> field themselves.
This is definitely valid (and more <span class="caps">DRY</span>) but less explicit than the way I&#8217;ve implemented this - i.e you may
wanted to not allow publishers to remove objects, only admins (so you could implement that differently in the <tt class="docutils literal">get_queryset</tt>
or <tt class="docutils literal">dispatch</tt> method of <tt class="docutils literal">ContentRemoveMixin</tt> and <tt class="docutils literal">ContentUpdateMixin</tt>) this is easier if you have both the
<tt class="docutils literal">ContentRemoveMixin</tt> and <tt class="docutils literal">ContentUnpublishMixin</tt>.</p>
<p>Now let&#8217;s take a look at the&nbsp;views:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CategoryListView</span><span class="p">(</span><span class="n">ExportCsvMixin</span><span class="p">,</span> <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;categories&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_queryset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qs</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">article_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;article&#39;</span><span class="p">),</span> <span class="n">document_cnt</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">))</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CategoryCreateView</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span> <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Category created!&#39;</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;category-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CategoryUpdateView</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span> <span class="n">AdminOrPublisherPermissionRequiredMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Category updated!&#39;</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;category-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CategoryDetailView</span><span class="p">(</span><span class="n">CategoriesContextMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Category</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;category&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ctx</span><span class="p">[</span><span class="s1">&#39;article_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">ctx</span><span class="p">[</span><span class="s1">&#39;document_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ctx</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleListView</span><span class="p">(</span><span class="n">ContentListMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;articles&#39;</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">ArticleFilter</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleCreateView</span><span class="p">(</span><span class="n">ContentCreateMixin</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ArticleForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;article-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleUpdateView</span><span class="p">(</span><span class="n">ContentUpdateMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ArticleForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;article-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleDetailView</span><span class="p">(</span><span class="n">HideRemovedMixin</span><span class="p">,</span> <span class="n">JsonDetailMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;article&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_template_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;partial&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;djangocbv/_article_content_partial.html&#39;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_template_names</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleRemoveView</span><span class="p">(</span><span class="n">ContentRemoveMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;article-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleUnpublishView</span><span class="p">(</span><span class="n">ContentUnpublishMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;article-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentListView</span><span class="p">(</span><span class="n">ContentListMixin</span><span class="p">,</span> <span class="n">ListView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;documents&#39;</span>
    <span class="n">filter_class</span> <span class="o">=</span> <span class="n">DocumentFilter</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentCreateView</span><span class="p">(</span><span class="n">ContentCreateMixin</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">DocumentForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;document-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentUpdateView</span><span class="p">(</span><span class="n">ContentUpdateMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">DocumentForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;document-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentDetailView</span><span class="p">(</span><span class="n">HideRemovedMixin</span><span class="p">,</span> <span class="n">JsonDetailMixin</span><span class="p">,</span> <span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;document&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentRemoveView</span><span class="p">(</span><span class="n">ContentRemoveMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;document-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocumentUnpublishView</span><span class="p">(</span><span class="n">ContentUnpublishMixin</span><span class="p">,</span> <span class="n">UpdateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Document</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;document-list&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DynamicTemplateView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_template_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;what&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>
</pre></div>
<p>As you will see there&nbsp;are</p>
<ul class="simple">
<li>4 views related to categories (Create, Detail, Update and&nbsp;List)</li>
<li>6 views related to articles (Create, Detail, Update, List, Unpublish and Remove)&nbsp;and</li>
<li>another 6 views related to documents (same as&nbsp;articles).</li>
</ul>
<p>The views for <tt class="docutils literal">Article</tt> and <tt class="docutils literal">Document</tt> are more or less the same: They inherit
from the corresponding mixin we defined previously (<tt class="docutils literal">CreateContentMixin</tt>, <tt class="docutils literal">UpdateContentMixin</tt> etc) add a
redirect to their corresponding list view (I am using <tt class="docutils literal">redirect_lazy</tt> there because <tt class="docutils literal">redirect</tt> wouldn&#8217;t work
because it will lead to a cyclic dependency between urls and views) and define their corresponding form and model.
For the the DetailViews I don&#8217;t use a group mixin like the others but I just add the <tt class="docutils literal">HideRemovedMixin</tt> and
<tt class="docutils literal">JsonDetailMixin</tt> directly to their ancestor list. This is to make clear that the group mixins (<tt class="docutils literal">ContentCreateMixin</tt> etc)
are optional and I could for example define <tt class="docutils literal">ArticleCreateView</tt> like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ArticleCreateView</span><span class="p">(</span><span class="n">SuccessMessageMixin</span><span class="p">,</span>
                    <span class="n">AuditableMixin</span><span class="p">,</span>
                    <span class="n">SetOwnerIfNeeded</span><span class="p">,</span>
                    <span class="n">RequestArgMixin</span><span class="p">,</span>
                    <span class="n">SetInitialMixin</span><span class="p">,</span>
                    <span class="n">ModerationMixin</span><span class="p">,</span>
                    <span class="n">LoginRequiredMixin</span><span class="p">,</span>
                    <span class="n">CreateView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Article</span>
    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ArticleForm</span>
    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">&#39;article-list&#39;</span><span class="p">)</span>
    <span class="n">success_message</span> <span class="o">=</span> <span class="s1">&#39;Object successfully created!&#39;</span>
</pre></div>
<p>What&#8217;s the advantage of using the  <tt class="docutils literal">ContentCreateMixin</tt>  then? Well since the same mixins are used from <tt class="docutils literal">DocumentCreateView</tt>
I won&#8217;t need to re-define this list there. Also if for example I want to allow users that have a specific permission to create
articles and document I will remove the <tt class="docutils literal">LoginRequireMixin</tt> and add the <tt class="docutils literal">AllowCreateContentMixin</tt> only to the <tt class="docutils literal">ContentCreateMixin</tt>
and not to both <tt class="docutils literal">ArticleCreateView</tt> and <tt class="docutils literal">DocumentCreateView</tt> (and I won&#8217;t be in danger of forgetting to change it somewhere).
Of course all this depends on your requirements and how <span class="caps">DRY</span> you need to&nbsp;be.</p>
<p>The category related views are simpler and override their mixins directly. Finally there&#8217;s a <tt class="docutils literal">DynamicTemplateView</tt> to
display templates based on their filename as discussed&nbsp;previously.</p>
<p>Before continuing, please try to understand how much more <span class="caps">DRY</span> this project is when compared to using a traditional
functional one (or if not using mixins). For example, there&#8217;s a <tt class="docutils literal">RequestArgMixin</tt> that is used by all views that create/update content. If <span class="caps">INHERITANCE</span>
didn&#8217;t use that mixin I&#8217;d need to re-define the same functionality (pass the current request to the form&#8217;s constructor) to
4 views (Article/Document Create/Update). Or for the <tt class="docutils literal">AuditableMixin</tt> I&#8217;d need to remember to upgrade the created/modified by
to 8 views (Article/Document&nbsp;Create/Update/Unpublish/Remove)!</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>The previous discussion should convince you how much more <span class="caps">DRY</span> your views will be when using CBVs and how
much quicker will be to create your views. Also, if
you followed closely the first and second chapters you should be able to understand everything that is
needed for CBVs and be able to properly understand which method or attribute you need to override to
implement some specific functionality. Finally, the list of examples in the third chapter should help
you get started in all your <span class="caps">CBV</span> needs - if you have some specific question about CBVs or you&#8217;d like
another use case added to the list feel free to ask and I&#8217;ll try to add&nbsp;it!</p>
<p><em>Update 21/04/2020</em> As per commenter&#8217;s Ahmed I. Elsayed comment, there are sites with a similar
functionality with the <span class="caps">CBV</span> inspector for the Django Rest Framework (<a class="reference external" href="http://www.cdrf.co/">http://www.cdrf.co/</a>) and
Django Forms (<a class="reference external" href="https://cdf.9vo.lt/">https://cdf.9vo.lt/</a>)! They are an excellent resource for&nbsp;reference!!</p>
</div>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Serafeim Papastefanos
    </span>
  </span>
<time datetime="2018-03-19T12:20:00+02:00" pubdate>Mon 19 March 2018</time>  <span class="categories">
    <a class='category' href='https://www.spapas.net/category/django.html'>django</a>
  </span>
  <span class="categories">
    <a class="category" href="https://www.spapas.net/tag/python.html">python</a>,    <a class="category" href="https://www.spapas.net/tag/cbv.html">cbv</a>,    <a class="category" href="https://www.spapas.net/tag/class-based-views.html">class-based-views</a>,    <a class="category" href="https://www.spapas.net/tag/django.html">django</a>  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="https://www.spapas.net/2018/03/19/comprehensive-django-cbv-guide/" data-via="" data-counturl="https://www.spapas.net/2018/03/19/comprehensive-django-cbv-guide/" >Tweet</a>
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  
  <section>
    <br />
    <a href='/feeds/all.atom.xml'>Atom</a>
    |
    <a href='/feeds/all.rss.xml'>RSS</a>
  </section>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Sidebar unit -->
  <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7673322832689008" data-ad-slot="2720624730"
    data-ad-format="auto" data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>


  <script async src="https://cse.google.com/cse.js?cx=612920e5ca9da850c"></script>
  <div class="gcse-search"></div>

  
  <section>
    <h1>Support me</h1>

    You can show your appreciation for anything useful you've found here by 
    buying me a coffee 
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="spapas" data-color="#FFDD00" data-emoji=""  data-font="Lato" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>

    or donating me some bitcoin to this address:
    <small><pre>bc1qx42vp8napheaewhnx0rk0mttdrdrtvw6czvxhl</pre></small>
    <svg shape-rendering="crispEdges" height="200" width="200" viewBox="0 0 29 29" class="qrcode">
      <path fill="#FFFFFF" d="M0,0 h29v29H0z"></path><path fill="#000000" d="M0 0h7v1H0zM9 0h2v1H9zM12 0h1v1H12zM14 0h2v1H14zM18 0h2v1H18zM22,0 h7v1H22zM0 1h1v1H0zM6 1h1v1H6zM8 1h1v1H8zM11 1h1v1H11zM14 1h5v1H14zM22 1h1v1H22zM28,1 h1v1H28zM0 2h1v1H0zM2 2h3v1H2zM6 2h1v1H6zM8 2h4v1H8zM17 2h1v1H17zM22 2h1v1H22zM24 2h3v1H24zM28,2 h1v1H28zM0 3h1v1H0zM2 3h3v1H2zM6 3h1v1H6zM9 3h2v1H9zM14 3h3v1H14zM18 3h1v1H18zM22 3h1v1H22zM24 3h3v1H24zM28,3 h1v1H28zM0 4h1v1H0zM2 4h3v1H2zM6 4h1v1H6zM8 4h1v1H8zM11 4h1v1H11zM13 4h1v1H13zM15 4h2v1H15zM18 4h1v1H18zM22 4h1v1H22zM24 4h3v1H24zM28,4 h1v1H28zM0 5h1v1H0zM6 5h1v1H6zM8 5h2v1H8zM14 5h2v1H14zM19 5h2v1H19zM22 5h1v1H22zM28,5 h1v1H28zM0 6h7v1H0zM8 6h1v1H8zM10 6h1v1H10zM12 6h1v1H12zM14 6h1v1H14zM16 6h1v1H16zM18 6h1v1H18zM20 6h1v1H20zM22,6 h7v1H22zM8 7h2v1H8zM11 7h1v1H11zM15 7h1v1H15zM17 7h2v1H17zM0 8h2v1H0zM3 8h1v1H3zM6 8h2v1H6zM10 8h1v1H10zM12 8h3v1H12zM20 8h1v1H20zM22 8h3v1H22zM26 8h2v1H26zM1 9h1v1H1zM3 9h3v1H3zM8 9h1v1H8zM10 9h1v1H10zM12 9h2v1H12zM16 9h2v1H16zM20 9h1v1H20zM22 9h1v1H22zM25 9h1v1H25zM27,9 h2v1H27zM0 10h1v1H0zM3 10h2v1H3zM6 10h1v1H6zM8 10h3v1H8zM12 10h2v1H12zM16 10h1v1H16zM19 10h1v1H19zM22 10h3v1H22zM27 10h1v1H27zM0 11h1v1H0zM2 11h1v1H2zM4 11h2v1H4zM7 11h1v1H7zM13 11h4v1H13zM18 11h4v1H18zM26 11h2v1H26zM0 12h1v1H0zM2 12h3v1H2zM6 12h1v1H6zM11 12h1v1H11zM13 12h1v1H13zM15 12h3v1H15zM20 12h1v1H20zM22 12h2v1H22zM27,12 h2v1H27zM4 13h1v1H4zM8 13h3v1H8zM12 13h1v1H12zM14 13h1v1H14zM17 13h4v1H17zM25 13h2v1H25zM0 14h1v1H0zM4 14h3v1H4zM8 14h2v1H8zM11 14h3v1H11zM16 14h1v1H16zM21 14h2v1H21zM24,14 h5v1H24zM3 15h3v1H3zM7 15h2v1H7zM10 15h1v1H10zM12 15h2v1H12zM15 15h1v1H15zM17 15h2v1H17zM20 15h2v1H20zM23 15h1v1H23zM1 16h1v1H1zM4 16h1v1H4zM6 16h4v1H6zM16 16h2v1H16zM20 16h1v1H20zM23 16h1v1H23zM25 16h1v1H25zM28,16 h1v1H28zM2 17h1v1H2zM5 17h1v1H5zM7 17h2v1H7zM11 17h3v1H11zM17 17h1v1H17zM22 17h1v1H22zM25 17h1v1H25zM27,17 h2v1H27zM0 18h1v1H0zM3 18h1v1H3zM5 18h4v1H5zM10 18h1v1H10zM12 18h1v1H12zM18 18h1v1H18zM20 18h1v1H20zM22 18h2v1H22zM25,18 h4v1H25zM2 19h3v1H2zM8 19h1v1H8zM16 19h2v1H16zM21 19h1v1H21zM23 19h1v1H23zM25 19h1v1H25zM27 19h1v1H27zM0 20h1v1H0zM2 20h5v1H2zM8 20h2v1H8zM13 20h4v1H13zM19 20h6v1H19zM26 20h1v1H26zM28,20 h1v1H28zM8 21h2v1H8zM12 21h3v1H12zM16 21h1v1H16zM20 21h1v1H20zM24 21h1v1H24zM26,21 h3v1H26zM0 22h7v1H0zM8 22h3v1H8zM17 22h1v1H17zM20 22h1v1H20zM22 22h1v1H22zM24 22h2v1H24zM27 22h1v1H27zM0 23h1v1H0zM6 23h1v1H6zM10 23h2v1H10zM13 23h2v1H13zM19 23h2v1H19zM24,23 h5v1H24zM0 24h1v1H0zM2 24h3v1H2zM6 24h1v1H6zM9 24h2v1H9zM12 24h2v1H12zM17 24h1v1H17zM20 24h6v1H20zM28,24 h1v1H28zM0 25h1v1H0zM2 25h3v1H2zM6 25h1v1H6zM8 25h3v1H8zM12 25h1v1H12zM14 25h1v1H14zM18 25h1v1H18zM22 25h3v1H22zM26 25h1v1H26zM0 26h1v1H0zM2 26h3v1H2zM6 26h1v1H6zM10 26h5v1H10zM16 26h3v1H16zM21 26h1v1H21zM24 26h1v1H24zM26 26h1v1H26zM28,26 h1v1H28zM0 27h1v1H0zM6 27h1v1H6zM8 27h3v1H8zM12 27h4v1H12zM17 27h1v1H17zM20 27h1v1H20zM23 27h2v1H23zM27 27h1v1H27zM0 28h7v1H0zM8 28h3v1H8zM14 28h1v1H14zM16 28h3v1H16zM20 28h1v1H20zM22 28h1v1H22zM24 28h2v1H24zM27 28h1v1H27z"></path>
    </svg>
  </section>
  

  <section>
    <h1>Subscribe</h1>
    Do you want to get notified via email when I post new content?
    <style>
      .subscribe-button {
        /* margin: 10px !important; */
        padding: 10px !important;
        background-color: black;
        display: inline-block;
        color: white !important;
        text-decoration: none;

        line-height: 36px !important;
        height: 37px !important;
        text-decoration: none !important;
        display: inline-block !important;
        color: #ffffff !important;
        background-color: #000000 !important;
        border-radius: 3px !important;
        border: 1px solid transparent !important;
        padding: 1px 9px !important;
        font-size: 23px !important;
        letter-spacing: 0.6px !important;
        box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
        -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
        margin: 0 auto !important;
        font-family: 'Cookie', cursive !important;
        -webkit-box-sizing: border-box !important;
        box-sizing: border-box !important;
        -o-transition: 0.3s all linear !important;
        -webkit-transition: 0.3s all linear !important;
        -moz-transition: 0.3s all linear !important;
        -ms-transition: 0.3s all linear !important;
        transition: 0.3s all linear !important;

      }
    </style>
    <a class='subscribe-button' target="_blank" href="http://eepurl.com/dxI3PP">Click here to subscribe!</a>
  </section>


  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
        <a href="https://www.spapas.net/2024/08/22/multiple-erl-elixir-windows/">Multiple Erlang/Elixir versions in Windows</a>
      </li>
      <li class="post">
        <a href="https://www.spapas.net/2023/11/29/openid-connect-tutorial/">A simple OpenID connect tutorial</a>
      </li>
      <li class="post">
        <a href="https://www.spapas.net/2023/05/23/simple-django-datatables-integration/">Simple Django - DataTables integration</a>
      </li>
      <li class="post">
        <a href="https://www.spapas.net/2023/05/22/ai-auto-subtitling/">AI auto-subtitling</a>
      </li>
      <li class="post">
        <a href="https://www.spapas.net/2023/05/12/disable-your-forms/">HTML form disable after submit</a>
      </li>
    </ul>
  </section>
  <section>

    <h1>Categories</h1>
    <ul id="recent_posts">
      <li><a href="https://www.spapas.net/category/ai.html">ai</a></li>
      <li><a href="https://www.spapas.net/category/android.html">android</a></li>
      <li><a href="https://www.spapas.net/category/clojure.html">clojure</a></li>
      <li><a href="https://www.spapas.net/category/css.html">css</a></li>
      <li><a href="https://www.spapas.net/category/django.html">django</a></li>
      <li><a href="https://www.spapas.net/category/elixir.html">elixir</a></li>
      <li><a href="https://www.spapas.net/category/flask.html">flask</a></li>
      <li><a href="https://www.spapas.net/category/gaming.html">gaming</a></li>
      <li><a href="https://www.spapas.net/category/git.html">git</a></li>
      <li><a href="https://www.spapas.net/category/html.html">html</a></li>
      <li><a href="https://www.spapas.net/category/javascript.html">javascript</a></li>
      <li><a href="https://www.spapas.net/category/networking.html">networking</a></li>
      <li><a href="https://www.spapas.net/category/pelican.html">pelican</a></li>
      <li><a href="https://www.spapas.net/category/postgresql.html">postgresql</a></li>
      <li><a href="https://www.spapas.net/category/python.html">python</a></li>
      <li><a href="https://www.spapas.net/category/spring.html">spring</a></li>
      <li><a href="https://www.spapas.net/category/unix.html">unix</a></li>
      <li><a href="https://www.spapas.net/category/wagtail.html">wagtail</a></li>
    </ul>
  </section>

  <section>
    <h1>Tags</h1>
    <a href="https://www.spapas.net/tag/erlang.html">erlang</a>,    <a href="https://www.spapas.net/tag/elixir.html">elixir</a>,    <a href="https://www.spapas.net/tag/windows.html">windows</a>,    <a href="https://www.spapas.net/tag/openid.html">openid</a>,    <a href="https://www.spapas.net/tag/openid-connect.html">openid-connect</a>,    <a href="https://www.spapas.net/tag/oidc.html">oidc</a>,    <a href="https://www.spapas.net/tag/http.html">http</a>,    <a href="https://www.spapas.net/tag/keycloak.html">keycloak</a>,    <a href="https://www.spapas.net/tag/python.html">python</a>,    <a href="https://www.spapas.net/tag/django.html">django</a>,    <a href="https://www.spapas.net/tag/jquery.html">jquery</a>,    <a href="https://www.spapas.net/tag/datatables.html">datatables</a>,    <a href="https://www.spapas.net/tag/ai.html">ai</a>,    <a href="https://www.spapas.net/tag/whisper.html">whisper</a>,    <a href="https://www.spapas.net/tag/whispercpp.html">whisper.cpp</a>,    <a href="https://www.spapas.net/tag/subtitles.html">subtitles</a>,    <a href="https://www.spapas.net/tag/video.html">video</a>,    <a href="https://www.spapas.net/tag/auto-subtitling.html">auto-subtitling</a>,    <a href="https://www.spapas.net/tag/subtitiling.html">subtitiling</a>,    <a href="https://www.spapas.net/tag/transcribe.html">transcribe</a>,    <a href="https://www.spapas.net/tag/html.html">html</a>,    <a href="https://www.spapas.net/tag/javascript.html">javascript</a>,    <a href="https://www.spapas.net/tag/media.html">media</a>,    <a href="https://www.spapas.net/tag/storage.html">storage</a>,    <a href="https://www.spapas.net/tag/unpoly.html">unpoly</a>,    <a href="https://www.spapas.net/tag/access.html">access</a>,    <a href="https://www.spapas.net/tag/database.html">database</a>,    <a href="https://www.spapas.net/tag/accdb.html">accdb</a>,    <a href="https://www.spapas.net/tag/mdb.html">mdb</a>,    <a href="https://www.spapas.net/tag/postgresql.html">postgresql</a>,    <a href="https://www.spapas.net/tag/development.html">development</a>,    <a href="https://www.spapas.net/tag/inlines.html">inlines</a>,    <a href="https://www.spapas.net/tag/clojure.html">clojure</a>,    <a href="https://www.spapas.net/tag/cmd.html">cmd</a>,    <a href="https://www.spapas.net/tag/pdf.html">pdf</a>,    <a href="https://www.spapas.net/tag/wkhtmltopdf.html">wkhtmltopdf</a>,    <a href="https://www.spapas.net/tag/forward-proxy.html">forward-proxy</a>,    <a href="https://www.spapas.net/tag/reverse-proxy.html">reverse-proxy</a>,    <a href="https://www.spapas.net/tag/proxy.html">proxy</a>,    <a href="https://www.spapas.net/tag/networking.html">networking</a>,    <a href="https://www.spapas.net/tag/dj-rest-auth.html">dj-rest-auth</a>,    <a href="https://www.spapas.net/tag/rest.html">rest</a>,    <a href="https://www.spapas.net/tag/django-rest-framework.html">django-rest-framework</a>,    <a href="https://www.spapas.net/tag/authentication.html">authentication</a>,    <a href="https://www.spapas.net/tag/tokens.html">tokens</a>,    <a href="https://www.spapas.net/tag/migrations.html">migrations</a>,    <a href="https://www.spapas.net/tag/foreignkey.html">foreignkey</a>,    <a href="https://www.spapas.net/tag/dark-souls.html">dark-souls</a>,    <a href="https://www.spapas.net/tag/dark-souls-2.html">dark-souls-2</a>,    <a href="https://www.spapas.net/tag/dark-souls-3.html">dark-souls-3</a>,    <a href="https://www.spapas.net/tag/autohotkey.html">autohotkey</a>,    <a href="https://www.spapas.net/tag/matplotlib.html">matplotlib</a>,    <a href="https://www.spapas.net/tag/hashids.html">hashids</a>,    <a href="https://www.spapas.net/tag/wagtail.html">wagtail</a>,    <a href="https://www.spapas.net/tag/osmon.html">osmon</a>,    <a href="https://www.spapas.net/tag/phoenix.html">phoenix</a>,    <a href="https://www.spapas.net/tag/os-monitoring.html">os-monitoring</a>,    <a href="https://www.spapas.net/tag/forms.html">forms</a>,    <a href="https://www.spapas.net/tag/django-crispy-forms.html">django-crispy-forms</a>,    <a href="https://www.spapas.net/tag/django-widget-tweaks.html">django-widget-tweaks</a>,    <a href="https://www.spapas.net/tag/ecto.html">ecto</a>,    <a href="https://www.spapas.net/tag/queries.html">queries</a>,    <a href="https://www.spapas.net/tag/declarative.html">declarative</a>,    <a href="https://www.spapas.net/tag/form.html">form</a>,    <a href="https://www.spapas.net/tag/php.html">php</a>,    <a href="https://www.spapas.net/tag/select2.html">select2</a>,    <a href="https://www.spapas.net/tag/autocompelte.html">autocompelte</a>,    <a href="https://www.spapas.net/tag/ajax.html">ajax</a>,    <a href="https://www.spapas.net/tag/android.html">android</a>,    <a href="https://www.spapas.net/tag/kotlin.html">kotlin</a>,    <a href="https://www.spapas.net/tag/adapter.html">adapter</a>,    <a href="https://www.spapas.net/tag/filter.html">filter</a>,    <a href="https://www.spapas.net/tag/async.html">async</a>,    <a href="https://www.spapas.net/tag/tasks.html">tasks</a>,    <a href="https://www.spapas.net/tag/django-rq.html">django-rq</a>,    <a href="https://www.spapas.net/tag/rq.html">rq</a>,    <a href="https://www.spapas.net/tag/du.html">du</a>,    <a href="https://www.spapas.net/tag/unix.html">unix</a>,    <a href="https://www.spapas.net/tag/linux.html">linux</a>,    <a href="https://www.spapas.net/tag/disk-usage.html">disk-usage</a>,    <a href="https://www.spapas.net/tag/cbv.html">cbv</a>,    <a href="https://www.spapas.net/tag/middleware.html">middleware</a>,    <a href="https://www.spapas.net/tag/class-based-views.html">class-based-views</a>,    <a href="https://www.spapas.net/tag/react.html">react</a>,    <a href="https://www.spapas.net/tag/redux.html">redux</a>,    <a href="https://www.spapas.net/tag/hyperapp.html">hyperapp</a>,    <a href="https://www.spapas.net/tag/immutable.html">immutable</a>,    <a href="https://www.spapas.net/tag/es6.html">es6</a>,    <a href="https://www.spapas.net/tag/youtube.html">youtube</a>,    <a href="https://www.spapas.net/tag/youtube-dl.html">youtube-dl</a>,    <a href="https://www.spapas.net/tag/ffmpeg.html">ffmpeg</a>,    <a href="https://www.spapas.net/tag/django-rest-auth.html">django-rest-auth</a>,    <a href="https://www.spapas.net/tag/python-2.html">python-2</a>,    <a href="https://www.spapas.net/tag/python-3.html">python-3</a>,    <a href="https://www.spapas.net/tag/plpgsql.html">plpgsql</a>,    <a href="https://www.spapas.net/tag/component.html">component</a>,    <a href="https://www.spapas.net/tag/ag-grid.html">ag-grid</a>,    <a href="https://www.spapas.net/tag/grid.html">grid</a>,    <a href="https://www.spapas.net/tag/bash.html">bash</a>,    <a href="https://www.spapas.net/tag/cron.html">cron</a>,    <a href="https://www.spapas.net/tag/pandas.html">pandas</a>,    <a href="https://www.spapas.net/tag/scipy.html">scipy</a>,    <a href="https://www.spapas.net/tag/numpy.html">numpy</a>,    <a href="https://www.spapas.net/tag/pivot.html">pivot</a>,    <a href="https://www.spapas.net/tag/pivot_table.html">pivot_table</a>,    <a href="https://www.spapas.net/tag/ipython.html">ipython</a>,    <a href="https://www.spapas.net/tag/jupyter.html">jupyter</a>,    <a href="https://www.spapas.net/tag/notebook.html">notebook</a>,    <a href="https://www.spapas.net/tag/query.html">query</a>,    <a href="https://www.spapas.net/tag/q.html">q</a>,    <a href="https://www.spapas.net/tag/imgur.html">imgur</a>,    <a href="https://www.spapas.net/tag/console.html">console</a>,    <a href="https://www.spapas.net/tag/research.html">research</a>,    <a href="https://www.spapas.net/tag/debug.html">debug</a>,    <a href="https://www.spapas.net/tag/werkzeug.html">werkzeug</a>,    <a href="https://www.spapas.net/tag/django-extensions.html">django-extensions</a>,    <a href="https://www.spapas.net/tag/404.html">404</a>,    <a href="https://www.spapas.net/tag/error.html">error</a>,    <a href="https://www.spapas.net/tag/spring.html">spring</a>,    <a href="https://www.spapas.net/tag/spring-boot.html">spring-boot</a>,    <a href="https://www.spapas.net/tag/java.html">java</a>,    <a href="https://www.spapas.net/tag/ldap.html">ldap</a>,    <a href="https://www.spapas.net/tag/profiles.html">profiles</a>,    <a href="https://www.spapas.net/tag/settings.html">settings</a>,    <a href="https://www.spapas.net/tag/properties.html">properties</a>,    <a href="https://www.spapas.net/tag/yaml.html">yaml</a>,    <a href="https://www.spapas.net/tag/configuration.html">configuration</a>,    <a href="https://www.spapas.net/tag/deploy.html">deploy</a>,    <a href="https://www.spapas.net/tag/initd.html">init.d</a>,    <a href="https://www.spapas.net/tag/react-redux.html">react-redux</a>,    <a href="https://www.spapas.net/tag/redux-thunk.html">redux-thunk</a>,    <a href="https://www.spapas.net/tag/redux-form.html">redux-form</a>,    <a href="https://www.spapas.net/tag/react-router.html">react-router</a>,    <a href="https://www.spapas.net/tag/react-router-redux.html">react-router-redux</a>,    <a href="https://www.spapas.net/tag/react-notification.html">react-notification</a>,    <a href="https://www.spapas.net/tag/history.html">history</a>,    <a href="https://www.spapas.net/tag/babel.html">babel</a>,    <a href="https://www.spapas.net/tag/babelify.html">babelify</a>,    <a href="https://www.spapas.net/tag/browserify.html">browserify</a>,    <a href="https://www.spapas.net/tag/watchify.html">watchify</a>,    <a href="https://www.spapas.net/tag/uglify.html">uglify</a>,    <a href="https://www.spapas.net/tag/boilerplate.html">boilerplate</a>,    <a href="https://www.spapas.net/tag/tutorial.html">tutorial</a>,    <a href="https://www.spapas.net/tag/introduction.html">introduction</a>,    <a href="https://www.spapas.net/tag/fixed-data-tables.html">fixed-data-tables</a>,    <a href="https://www.spapas.net/tag/fixeddatatable.html">FixedDataTable</a>,    <a href="https://www.spapas.net/tag/reportlab.html">reportlab</a>,    <a href="https://www.spapas.net/tag/xhtml2pdf.html">xhtml2pdf</a>,    <a href="https://www.spapas.net/tag/node.html">node</a>,    <a href="https://www.spapas.net/tag/npm.html">npm</a>,    <a href="https://www.spapas.net/tag/generic.html">generic</a>,    <a href="https://www.spapas.net/tag/tables.html">tables</a>,    <a href="https://www.spapas.net/tag/flux.html">flux</a>,    <a href="https://www.spapas.net/tag/jobs.html">jobs</a>,    <a href="https://www.spapas.net/tag/asynchronous.html">asynchronous</a>,    <a href="https://www.spapas.net/tag/scheduling.html">scheduling</a>,    <a href="https://www.spapas.net/tag/redis.html">redis</a>,    <a href="https://www.spapas.net/tag/pusher.html">pusher</a>,    <a href="https://www.spapas.net/tag/auditing.html">auditing</a>,    <a href="https://www.spapas.net/tag/css.html">css</a>,    <a href="https://www.spapas.net/tag/design.html">design</a>,    <a href="https://www.spapas.net/tag/boostrap-material-design.html">boostrap-material-design</a>,    <a href="https://www.spapas.net/tag/less.html">less</a>,    <a href="https://www.spapas.net/tag/nodejs.html">node.js</a>,    <a href="https://www.spapas.net/tag/gmail.html">gmail</a>,    <a href="https://www.spapas.net/tag/security.html">security</a>,    <a href="https://www.spapas.net/tag/google.html">google</a>,    <a href="https://www.spapas.net/tag/flask.html">flask</a>,    <a href="https://www.spapas.net/tag/mongodb.html">mongodb</a>,    <a href="https://www.spapas.net/tag/heroku.html">heroku</a>,    <a href="https://www.spapas.net/tag/spring-security.html">spring-security</a>,    <a href="https://www.spapas.net/tag/git.html">git</a>,    <a href="https://www.spapas.net/tag/github.html">github</a>,    <a href="https://www.spapas.net/tag/branching.html">branching</a>,    <a href="https://www.spapas.net/tag/static-html.html">static-html</a>,    <a href="https://www.spapas.net/tag/githubio.html">github.io</a>,    <a href="https://www.spapas.net/tag/pelican.html">pelican</a>,    <a href="https://www.spapas.net/tag/github-pages.html">github-pages</a>,    <a href="https://www.spapas.net/tag/rst.html">rst</a>  </section>

  <section>
    <h1>Yearly archives</h1>
    <a href="https://www.spapas.net/posts/2013/">2013</a>,    <a href="https://www.spapas.net/posts/2014/">2014</a>,    <a href="https://www.spapas.net/posts/2015/">2015</a>,    <a href="https://www.spapas.net/posts/2016/">2016</a>,    <a href="https://www.spapas.net/posts/2017/">2017</a>,    <a href="https://www.spapas.net/posts/2018/">2018</a>,    <a href="https://www.spapas.net/posts/2019/">2019</a>,    <a href="https://www.spapas.net/posts/2020/">2020</a>,    <a href="https://www.spapas.net/posts/2021/">2021</a>,    <a href="https://www.spapas.net/posts/2022/">2022</a>,    <a href="https://www.spapas.net/posts/2023/">2023</a>,    <a href="https://www.spapas.net/posts/2024/">2024</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/spapas">@spapas</a> on GitHub
    <script  src="//code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script type="text/javascript">
      $(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'https://www.spapas.net/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'spapas',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="https://www.spapas.net/theme/js/github.js" type="text/javascript"> </script>
  </section>


  <section>
    <a href="https://twitter.com/_serafeim_?ref_src=twsrc%5Etfw" class="twitter-follow-button"
      data-show-count="false">Follow @_serafeim_</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </section>

</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2013&ndash;2024  Serafeim Papastefanos &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="https://www.spapas.net/theme/js/modernizr-2.0.js"></script>
  <script src="https://www.spapas.net/theme/js/ender.js"></script>
  <script src="https://www.spapas.net/theme/js/octopress.js" type="text/javascript"></script>
  <script src="https://www.spapas.net/theme/js/ads.js"></script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44750952-1', 'auto');

    ga('send', 'pageview');
    </script>

<script defer data-domain="spapas.net" src="https://plausible.hcg.gr/js/script.js"></script>  <script type="text/javascript">
    var disqus_shortname = 'spapas-github-io';
    var disqus_identifier = '/2018/03/19/comprehensive-django-cbv-guide/';
    var disqus_url = 'https://www.spapas.net/2018/03/19/comprehensive-django-cbv-guide/';
    var disqus_title = 'A comprehensive Django <span class="caps">CBV</span>&nbsp;guide';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>

</body>

</html>